<!DOCTYPE html>
<html lang="en-US">
<head>
  <title> Install Mobile</title>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-52DXT37');</script>
	<!-- End Google Tag Manager -->
	<!-- Docsearch -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
	<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
	<!-- End Docsearch -->

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="//s.w.org">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.7.4"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}</style>
	<link rel="stylesheet" id="all-css-0" href="/_static/??-eJyVkE1uAjEMhS9ECD8ViEXVsxjHmjEkThQbMbk96WIqKhYwOz/5ffaz/b04zGIk5m2kROpLs1xx9KBKph5VPUugad2rlf/IPxIEqgsAg7MusCuhcZYlC2iyhQewDH8EC8Zb6N6L+kSBgWJH+4hnUSI0qi7SANjWieU93nvP+h80pyzxNrD0XDmQ0yYGkzvHjNc5cKmsyQ0j5pjr6xtnXjmV2JwaGKMrNc+8anFK0F/wy/6k7+3ha7PZ7vbH0wMn2c1p" type="text/css" media="all">
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="alternate" type="application/json" href="/wp-json/wp/v2/pages/57">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.7.4">
<link rel="canonical" href="/install/install-mobile/">
<link rel="shortlink" href="/?p=57">
		<meta name="ssp-url" content="">
		<meta name="ssp-config-url" content="/wp-content/plugins/simply-static-pro/configs/">
		<style type="text/css">img#wpstats{display:none}</style>
		</head>

<body class="page-template-default page page-id-57 page-parent page-child parent-pageid-78">
    <a href="#main">Skip to content</a>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-52DXT37" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<div>
	<header class="mainHeader">
		<div class="container">
			<div class="logo">
				<a href="/" aria-lable="PyTorch Logo">
					<svg role="img" width="109" height="27" viewbox="0 0 109 27" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.6172 5.92839L13.1892 7.32839C15.5692 9.66172 15.5692 13.4617 13.1892 15.7951C10.8092 18.1284 6.93316 18.1284 4.55316 15.7951C2.17316 13.4617 2.17316 9.66172 4.55316 7.32839L8.36116 3.59505L8.83716 3.06172V0.261719L3.05716 5.92839C-0.138844 9.06172 -0.138844 14.0617 3.05716 17.1951C6.25316 20.3284 11.3532 20.3284 14.5492 17.1951C17.8132 14.0617 17.8132 8.99505 14.6172 5.92839Z" fill="#DE3412"></path>
<ellipse cx="11.7618" cy="4.4612" rx="1.088" ry="1.06667" fill="#DE3412"></ellipse>
<path fill-rule="evenodd" clip-rule="evenodd" d="M26.5048 13.23H28.9435C33.3467 13.1625 36.1242 11.205 36.1242 7.29C36.1242 3.9825 33.8887 1.6875 29.1467 1.6875H24.6758V19.5075H26.5048V13.23ZM26.4371 3.375H29.079C32.4661 3.375 34.2274 4.7925 34.2274 7.29C34.2274 10.0575 32.3984 11.4075 29.0113 11.475L26.4371 11.5425V3.375Z" fill="#262626"></path>
<path d="M44.3887 19.4405L43.3048 22.2755C42.0855 25.448 40.8661 26.393 39.0371 26.393C38.021 26.393 37.2758 26.123 36.4629 25.7855L37.0048 24.1655C37.6145 24.503 38.2919 24.7055 39.0371 24.7055C40.0532 24.7055 40.7984 24.1655 41.7468 21.668L42.6274 19.373L37.5468 6.48047H39.4435L43.5758 17.2805L47.6403 6.48047H49.4693L44.3887 19.4405Z" fill="#262626"></path>
<path d="M55.5665 3.4425V19.575H53.7375V3.4425H47.4375V1.6875H61.8665V3.375H55.5665V3.4425Z" fill="#262626"></path>
<path fill-rule="evenodd" clip-rule="evenodd" d="M60.6465 13.0277C60.6465 17.2127 63.3562 19.9127 67.0142 19.9127C70.6723 19.9127 73.4497 17.1452 73.4497 12.9602C73.4497 8.7752 70.8078 6.0752 67.1497 6.0752C63.4239 6.0752 60.6465 8.8427 60.6465 13.0277ZM62.4746 12.9613C62.4746 9.92379 64.3036 7.69629 67.0811 7.69629C69.8585 7.69629 71.7553 9.85629 71.7553 13.0288C71.7553 16.0663 69.9262 18.2938 67.1488 18.2938C64.3714 18.2938 62.4746 16.1338 62.4746 12.9613Z" fill="#262626"></path>
<path d="M77.9879 19.5731H76.2266V6.47813L77.9879 6.14062V8.90812C78.8685 7.22062 80.1556 6.14062 81.8491 6.14062C82.7298 6.14062 83.5427 6.41063 84.1524 6.74813L83.6782 8.43563C83.1362 8.09813 82.3911 7.89562 81.6459 7.89562C80.2911 7.89562 79.004 8.90813 77.9201 11.2706V19.5731H77.9879Z" fill="#262626"></path>
<path d="M91.1308 19.9127C87.2018 19.9127 84.6953 17.0777 84.6953 13.0277C84.6953 8.9102 87.405 6.0752 91.1308 6.0752C92.7566 6.0752 94.1114 6.4802 95.2631 7.2227L94.7889 8.8427C93.7727 8.1677 92.5534 7.7627 91.1308 7.7627C88.2856 7.7627 86.5243 9.8552 86.5243 12.9602C86.5243 16.1327 88.4211 18.2252 91.1985 18.2252C92.4856 18.2252 93.8405 17.8202 94.8566 17.1452L95.1953 18.7652C94.0437 19.5077 92.6211 19.9127 91.1308 19.9127Z" fill="#262626"></path>
<path d="M106.238 19.575V11.1375C106.238 8.8425 105.29 7.83 103.461 7.83C101.97 7.83 100.48 8.5725 99.3961 9.72V19.6425H97.6348V0.3375L99.3961 0C99.3961 0 99.3961 8.1675 99.3961 8.235C100.751 6.885 102.512 6.1425 103.935 6.1425C106.509 6.1425 108.067 7.7625 108.067 10.5975V19.575H106.238Z" fill="#262626"></path>
</svg>
				</a>
			</div>
			<div class="content-container">
				<ul class="mainNav">
					<li class="mainItem search" key="search">
						<button id="search-icon" aria-label="search">
							<svg role="img" width="17" height="16" viewbox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M11.7461 7C11.7461 9.48528 9.73137 11.5 7.24609 11.5C4.76081 11.5 2.74609 9.48528 2.74609 7C2.74609 4.51472 4.76081 2.5 7.24609 2.5C9.73137 2.5 11.7461 4.51472 11.7461 7ZM10.9253 11.7399C9.90931 12.5297 8.63263 13 7.24609 13C3.93239 13 1.24609 10.3137 1.24609 7C1.24609 3.68629 3.93239 1 7.24609 1C10.5598 1 13.2461 3.68629 13.2461 7C13.2461 8.38653 12.7758 9.66322 11.986 10.6792L15.2764 13.9697L14.2158 15.0303L10.9253 11.7399Z" fill="#262626"></path>
</svg>
						</button>
						<div class="search-border">
							<div id="inner-search-icon">
								<svg role="img" width="17" height="16" viewbox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M11.7461 7C11.7461 9.48528 9.73137 11.5 7.24609 11.5C4.76081 11.5 2.74609 9.48528 2.74609 7C2.74609 4.51472 4.76081 2.5 7.24609 2.5C9.73137 2.5 11.7461 4.51472 11.7461 7ZM10.9253 11.7399C9.90931 12.5297 8.63263 13 7.24609 13C3.93239 13 1.24609 10.3137 1.24609 7C1.24609 3.68629 3.93239 1 7.24609 1C10.5598 1 13.2461 3.68629 13.2461 7C13.2461 8.38653 12.7758 9.66322 11.986 10.6792L15.2764 13.9697L14.2158 15.0303L10.9253 11.7399Z" fill="#262626"></path>
</svg>
							</div>
								<input id="input" type="text" placeholder="Search" title="Search" autocomplete="off" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-label="search input">
							
							<div id="close-search">X</div>
						</div>
					</li>
					<li class="mainItem menuIcon">
						<span class="hamburger"><svg role="img" width="22" height="18" viewbox="0 0 22 18" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M21.5 2.125H0.5V0.625H21.5V2.125ZM21.5 17.625H0.5V16.125H21.5V17.625ZM0.5 9.75H21.5V8.25H0.5V9.75Z" fill="black"></path>
</svg>
</span>
						<span class="close"><svg role="img" width="22" height="22" viewbox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M11.0001 12.0607L20.2197 21.2803L21.2804 20.2197L12.0607 11L21.2804 1.78033L20.2197 0.719675L11.0001 9.93934L1.78039 0.719673L0.719727 1.78033L9.9394 11L0.719727 20.2197L1.78039 21.2803L11.0001 12.0607Z" fill="black"></path>
</svg>
</span>
					</li>
					<li class="navItems">
						<ul class="navItemsContainer">
																														<li class="mainItem home-menu">
									<a class="parentTitle" href="/" target="">
										<span>
											Home										</span>
									</a>
																	</li>
																							<li class="mainItem active install-menu">
									<a class="parentTitle" href="/install/install-overview/" target="">
										<span>
											Install										</span>
									</a>
																			<div class="subitems-container">
											<div class="subitems-wrapper">
												<ul class="subItems">
																											<li class="subItem ">
															<a class="link" href="/install/install-overview/" target="">
																<p class="title">Overview</p>
																														</a>
														</li>
																											<li class="subItem ">
															<a class="link" href="/install/install-locally/" target="">
																<p class="title">Install Locally</p>
																														</a>
														</li>
																											<li class="subItem subActive">
															<a class="link" href="/install/install-mobile/" target="">
																<p class="title">Install Mobile</p>
																														</a>
														</li>
																											<li class="subItem ">
															<a class="link" href="/install/start-with-cloud-partners/" target="">
																<p class="title">Start with Cloud Partners</p>
																														</a>
														</li>
																											<li class="subItem ">
															<a class="link" href="/install/previous-versions/" target="">
																<p class="title">Previous PyTorch Versions</p>
																														</a>
														</li>
																									</ul>
											</div>
										</div>
																	</li>
																							<li class="mainItem features-menu">
									<a class="parentTitle" href="/features/features-overview/" target="">
										<span>
											Features										</span>
									</a>
																	</li>
																							<li class="mainItem resources-menu">
									<a class="parentTitle" href="/resources/overview/" target="">
										<span>
											Resources										</span>
									</a>
																			<div class="subitems-container">
											<div class="subitems-wrapper">
												<ul class="subItems">
																											<li class="subItem ">
															<a class="link" href="/resources/overview/" target="">
																<p class="title">Overview</p>
																														</a>
														</li>
																											<li class="subItem ">
															<a class="link" href="/resources/blog/" target="">
																<p class="title">Blog</p>
																														</a>
														</li>
																											<li class="subItem ">
															<a class="link" href="/resources/education/" target="">
																<p class="title">Education</p>
																														</a>
														</li>
																											<li class="subItem ">
															<a class="link" href="/resources/localized-docs-tutorials/" target="">
																<p class="title">Localized Docs &#038; Tutorials</p>
																														</a>
														</li>
																											<li class="subItem ">
															<a class="link" href="/resources/enterprise-program/" target="">
																<p class="title">Enterprise Program</p>
																														</a>
														</li>
																									</ul>
											</div>
										</div>
																	</li>
																							<li class="mainItem docs-menu">
									<a class="parentTitle" href="https://pytorch.org/docs/stable/index.html" target="_blank">
										<span>
											Docs										</span>
									</a>
																	</li>
																							<li class="mainItem tutorials-menu">
									<a class="parentTitle" href="https://pytorch.org/tutorials/" target="_blank">
										<span>
											Tutorials										</span>
									</a>
																	</li>
																							<li class="mainItem community-menu">
									<a class="parentTitle" href="/community/overview/" target="">
										<span>
											Community										</span>
									</a>
																			<div class="subitems-container">
											<div class="subitems-wrapper">
												<ul class="subItems">
																											<li class="subItem ">
															<a class="link" href="/community/overview/" target="">
																<p class="title">Overview</p>
																														</a>
														</li>
																											<li class="subItem ">
															<a class="link" href="/community/case-studies/" target="">
																<p class="title">Case Studies</p>
																														</a>
														</li>
																											<li class="subItem ">
															<a class="link" href="/community/ecosystem-tools/" target="">
																<p class="title">Ecosystem Tools</p>
																														</a>
														</li>
																											<li class="subItem ">
															<a class="link" href="/community/events/" target="">
																<p class="title">Events</p>
																														</a>
														</li>
																									</ul>
											</div>
										</div>
																	</li>
														<li class="github mainItem">
								<div class="github-wrapper">
									<a href="https://github.com/pytorch/pytorch" target="_blank" class="parentTitle" aria-label="See Pytorch on GitHub">
										<svg role="img" width="25" height="24" viewbox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M23.0227 6.33146C21.9311 4.51257 20.4504 3.07256 18.5803 2.01109C16.7099 0.949571 14.6679 0.418945 12.453 0.418945C10.2384 0.418945 8.19578 0.949733 6.32575 2.01109C4.45545 3.07251 2.97484 4.51257 1.88325 6.33146C0.791831 8.15029 0.246094 10.1365 0.246094 12.2899C0.246094 14.8767 1.02214 17.2029 2.57462 19.2689C4.12694 21.3351 6.1323 22.7648 8.59054 23.5582C8.87669 23.6099 9.08851 23.5736 9.22624 23.4502C9.36403 23.3266 9.43284 23.1719 9.43284 22.9866C9.43284 22.9557 9.43011 22.6776 9.42482 22.152C9.41936 21.6263 9.4168 21.1677 9.4168 20.7765L9.05121 20.838C8.81812 20.8795 8.52407 20.8971 8.16906 20.8921C7.81422 20.8873 7.44584 20.8511 7.06445 20.7839C6.68288 20.7172 6.32798 20.5627 5.99947 20.3205C5.67113 20.0783 5.43803 19.7614 5.30025 19.37L5.14131 19.0143C5.03537 18.7775 4.86858 18.5145 4.64072 18.2261C4.41286 17.9375 4.18244 17.7418 3.94935 17.6388L3.83806 17.5613C3.76391 17.5098 3.6951 17.4477 3.63147 17.3757C3.5679 17.3036 3.5203 17.2315 3.48851 17.1593C3.45667 17.087 3.48305 17.0277 3.56795 16.9812C3.65285 16.9347 3.80628 16.9121 4.0289 16.9121L4.34667 16.9583C4.55861 16.9996 4.82076 17.123 5.13346 17.3292C5.44599 17.5353 5.70291 17.8032 5.90427 18.1328C6.14811 18.5554 6.44188 18.8774 6.78643 19.099C7.13069 19.3206 7.4778 19.4312 7.82741 19.4312C8.17702 19.4312 8.47898 19.4054 8.73339 19.3542C8.98753 19.3026 9.22596 19.2252 9.44859 19.1222C9.54395 18.4315 9.8036 17.9008 10.2273 17.5299C9.62339 17.4682 9.08044 17.3752 8.59817 17.2516C8.11617 17.1279 7.61809 16.927 7.10425 16.6485C6.59013 16.3704 6.16364 16.025 5.82466 15.613C5.48563 15.2008 5.20739 14.6596 4.99033 13.99C4.77316 13.3201 4.66455 12.5473 4.66455 11.6714C4.66455 10.4243 5.08319 9.36302 5.92031 8.48704C5.52816 7.54944 5.56518 6.49837 6.03148 5.33393C6.33878 5.24108 6.7945 5.31076 7.39841 5.54253C8.00244 5.77441 8.44468 5.97305 8.7256 6.13775C9.00651 6.30238 9.23159 6.4419 9.40116 6.55506C10.3868 6.28723 11.404 6.15328 12.4529 6.15328C13.5018 6.15328 14.5192 6.28723 15.5049 6.55506L16.1089 6.18425C16.5219 5.93683 17.0096 5.71009 17.5709 5.50398C18.1325 5.29798 18.562 5.24124 18.8588 5.33409C19.3354 6.49859 19.3779 7.54961 18.9857 8.4872C19.8227 9.36319 20.2415 10.4247 20.2415 11.6715C20.2415 12.5474 20.1325 13.3227 19.9157 13.9977C19.6986 14.6729 19.4179 15.2135 19.0737 15.6208C18.729 16.028 18.2998 16.3706 17.786 16.6487C17.272 16.927 16.7738 17.1278 16.2918 17.2516C15.8096 17.3754 15.2666 17.4684 14.6627 17.5302C15.2135 17.9937 15.4889 18.7254 15.4889 19.725V22.9862C15.4889 23.1715 15.5552 23.3261 15.6878 23.4497C15.8202 23.5731 16.0294 23.6095 16.3155 23.5578C18.7741 22.7644 20.7795 21.3347 22.3317 19.2685C23.8838 17.2024 24.6602 14.8763 24.6602 12.2895C24.6596 10.1363 24.1136 8.15029 23.0227 6.33146Z" fill="#262626"></path>
</svg>
									</a>
								</div>
							</li>
						</ul>
						
<div class="navItems-followContainer followMenu ">
			<div class="mainItem">Follow Us</div>
		<ul class="follow-list">
					<li class="followItem">
				<a href="https://twitter.com/pytorch" target="_blank" class=" icon-twitter">
					Twitter				</a>
			</li>
					<li class="followItem">
				<a href="https://www.facebook.com/pytorch" target="_blank" class=" icon-facebook">
					Facebook				</a>
			</li>
					<li class="followItem">
				<a href="https://www.youtube.com/pytorch" target="_blank" class=" icon-youtube">
					YouTube				</a>
			</li>
					<li class="followItem">
				<a href="https://www.linkedin.com/company/pytorch" target="_blank" class=" icon-linkedin">
					Linkedin				</a>
			</li>
					<li class="followItem">
				<a href="https://medium.com/pytorch" target="_blank" class=" icon-medium">
					Medium				</a>
			</li>
					<li class="followItem">
				<a href="https://github.com/pytorch/pytorch" target="_blank" class=" icon-github">
					GitHub				</a>
			</li>
			</ul>
</div>
					</li>
				</ul>
			</div>
		</div>
	</header>

	<main id="main" class="site-main" role="main">

		<div class="Navigation is-style-secondary">
		<ul class="menu">
							<li class="">
					<a href="/install/install-overview/">Overview</a>
				</li>
							<li class="">
					<a href="/install/install-locally/">Install Locally</a>
				</li>
							<li class="current-menu-item">
					<a href="/install/install-mobile/">Install Mobile</a>
				</li>
							<li class="">
					<a href="/install/start-with-cloud-partners/">Start with Cloud Partners</a>
				</li>
							<li class="">
					<a href="/install/previous-versions/">Previous PyTorch Versions</a>
				</li>
					</ul>
	</div>
	
	<article id="post-57" class="post-57 page type-page status-publish hentry">
		<div class="entry-content">
			
<div class="Header layout-header-b">
	
<div class="content ">
					<h2 class="heading">
							<span class="line-1">Pytorch Mobile</span>
								</h2>
	
			<p class="description">End-to-end workflow from Training to Deployment for iOS and Android mobile devices</p>
		</div>
</div>



  


<div class="Tabs">
	
<div class="Navigation is-style-tertiary">
	<ul id="menu-install-on-mobile" class="menu">
<li id="nav-menu-item-3028" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item"><button>iOS</button></li>
<li id="nav-menu-item-3027" class="menu-item menu-item-type-post_type menu-item-object-page"><button>ANDROID</button></li>
</ul>
</div>
	<ul class="tab-content-container">
					<li class="tab-content active">
									<div class="two-column-container">
						<div class="content">
							<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3d151b2b-7355-4570-ab5a-99ac27601583">
		
	iOS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To get started with PyTorch on iOS, we recommend exploring the following <a href="https://github.com/pytorch/ios-demo-app/tree/master/HelloWorld">HelloWorld</a>.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-16aa6cb6-39a8-498c-8cf4-e2bdf810ff95">
		
	QUICKSTART WITH A HELLO WORLD EXAMPLE</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">HelloWorld is a simple image classification application that demonstrates how to use PyTorch C++ libraries on iOS. The code is written in Swift and uses Objective-C as a bridge.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-73027d8e-0449-43f2-9ab5-4bd78577dd6a">
		
	Model Preparation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Let’s start with model preparation. If you are familiar with PyTorch, you probably should already know how to train and save your model. In case you don’t, we are going to use a pre-trained image classification model &#8211; <a href="https://pytorch.org/hub/pytorch_vision_mobilenet_v2/">MobileNet v2</a>, which is already packaged in <a href="https://pytorch.org/docs/stable/torchvision/index.html">TorchVision</a>. To install it, run the command below.</p>
	</div>
</div>



<div class="TextBlock is-style-code-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><em>We highly recommend following the </em><a href="https://github.com/pytorch/pytorch">Pytorch Github page</a><em> to set up the Python development environment on your local machine.</em></p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pip install torchvision</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Once we have TorchVision installed successfully, let’s navigate to the HelloWorld folder and run <code>trace_model.py</code>. The script contains the code of tracing and saving a <a href="https://pytorch.org/tutorials/beginner/Intro_to_TorchScript_tutorial.html">torchscript model</a> that can be run on mobile devices.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">python trace_model.py</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">If everything works well, we should have our model &#8211; <code>model.pt</code> generated in the <code>HelloWorld</code> folder. Now copy the model file to our application folder <code>HelloWorld/model</code>.</p>
	</div>
</div>



<div class="TextBlock is-style-code-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><em>To find out more details about TorchScript, please visit </em><a href="https://pytorch.org/tutorials/advanced/cpp_export.html">tutorials on pytorch.org</a></p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-0798c42c-5031-4382-bfcb-a0c27e3bcfd5">
		
	Install LibTorch-Lite via Cocoapods</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The PyTorch C++ library is available in <a href="https://cocoapods.org/">Cocoapods</a>, to integrate it to our project, simply run</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pod install</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Now it’s time to open the <code>HelloWorld.xcworkspace</code> in XCode, select an iOS simulator and launch it (cmd + R). If everything works well, we should see a wolf picture on the simulator screen along with the prediction result.</p>
	</div>
</div>


<div class="BlogImage BlogImage">

	<div class="container">
		<div class="imageCon">
			
<img class="Image image" src="/wp-content/uploads/2021/11/wolf.png" alt="">
		</div>
	</div>
</div>


<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-918a3d1d-3327-4ce0-8264-8c77c9990219">
		
	Code Walkthrough</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">In this part, we are going to walk through the code step by step.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-5f9b5885-e413-4e46-b911-8cc0bc3f4a6b">
		
	Image Loading</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Let’s begin with image loading.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">let image = UIImage(named: "image.jpg")!
imageView.image = image
let resizedImage = image.resized(to: CGSize(width: 224, height: 224))
guard var pixelBuffer = resizedImage.normalized() else {
    return
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">We first load the image from our bundle and resize it to 224&#215;224. Then we call this <code>normalized()</code> category method to normalized the pixel buffer. Let’s take a closer look at the code below.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">var normalizedBuffer: [Float32] = [Float32](repeating: 0, count: w * h * 3)
// normalize the pixel buffer
// see https://pytorch.org/hub/pytorch_vision_resnet/ for more detail
for i in 0 ..&lt; w * h {
    normalizedBuffer[i]             = (Float32(rawBytes[i * 4 + 0]) / 255.0 - 0.485) / 0.229 // R
    normalizedBuffer[w * h + i]     = (Float32(rawBytes[i * 4 + 1]) / 255.0 - 0.456) / 0.224 // G
    normalizedBuffer[w * h * 2 + i] = (Float32(rawBytes[i * 4 + 2]) / 255.0 - 0.406) / 0.225 // B
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The code might look weird at first glance, but it’ll make sense once we understand our model. The input data is a 3-channel RGB image of shape (3 x H x W), where H and W are expected to be at least 224. The image has to be loaded in to a range of <code>[0, 1]</code> and then normalized using <code>mean = [0.485, 0.456, 0.406]</code> and <code>std = [0.229, 0.224, 0.225]</code>.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-959d41a1-c5fa-4cd6-9780-524c8bba1096">
		
	TorchScript Module</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Now that we have preprocessed our input data and we have a pre-trained TorchScript model, the next step is to use them to run predication. To do that, we’ll first load our model into the application.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">private lazy var module: TorchModule = {
    if let filePath = Bundle.main.path(forResource: "model", ofType: "pt"),
        let module = TorchModule(fileAtPath: filePath) {
        return module
    } else {
        fatalError("Can't find the model file!")
    }
}()</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Note that the <code>TorchModule</code> Class is an Objective-C wrapper of <code>torch::jit::mobile::Module</code>.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">torch::jit::mobile::Module module = torch::jit::_load_for_mobile(filePath.UTF8String);</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Since Swift can not talk to C++ directly, we have to either use an Objective-C class as a bridge, or create a C wrapper for the C++ library. For demo purpose, we’re going to wrap everything in this Objective-C class.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-c96161ee-4ca4-44a4-bf81-4282332d981d">
		
	Run Inference</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Now it’s time to run inference and get the results.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">guard let outputs = module.predict(image: UnsafeMutableRawPointer(&amp;pixelBuffer)) else {
    return
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Again, the <code>predict</code> method is just an Objective-C wrapper. Under the hood, it calls the C++ <code>forward</code> function. Let’s take a look at how it’s implemented.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="cpp" class="language-cpp">at::Tensor tensor = torch::from_blob(imageBuffer, {1, 3, 224, 224}, at::kFloat);
c10::InferenceMode guard;
auto outputTensor = _impl.forward({tensor}).toTensor();
float* floatBuffer = outputTensor.data_ptr&lt;float&gt;();</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The C++ function <code>torch::from_blob</code> will create an input tensor from the pixel buffer. Note that the shape of the tensor is <code>{1,3,224,224}</code> which represents <code>{N, C, H, W}</code> as we discussed in the above section.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="cpp" class="language-cpp">c10::InferenceMode guard;</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The above line tells PyTorch to do inference only.<br><br>Finally, we can call this <code>forward</code> function to get the output tensor and convert it to a <code>float</code> buffer.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">auto outputTensor = _impl.forward({tensor}).toTensor();
float* floatBuffer = outputTensor.data_ptr&lt;float&gt;();</code></pre>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-66cbf17c-2e28-4679-938d-61899ea1d9b7">
		
	Collect Results</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The output tensor is a one-dimensional float array of shape 1&#215;1000, where each value represents the confidence that a label is predicted from the image. The code below sorts the array and retrieves the top three results.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">let zippedResults = zip(labels.indices, outputs)
let sortedResults = zippedResults.sorted { $0.1.floatValue &gt; $1.1.floatValue }.prefix(3)</code></pre>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-e42b810a-dec4-419e-8e1e-b935eb7e4da1">
		
	PYTORCH DEMO APP</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">For more complex use cases, we recommend to check out the <a href="https://github.com/pytorch/ios-demo-app">PyTorch demo application</a>. The demo app contains two showcases. A camera app that runs a quantized model to predict the images coming from device’s rear-facing camera in real time. And a text-based app that uses a text classification model to predict the topic from the input string.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-83a3168e-f9bd-4531-9a92-a3b65da52e1f">
		
	MORE PYTORCH IOS DEMO APPS</h2>
	</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-0feec513-7e2e-4aeb-a433-282255523372">
		
	Image Segmentation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/ImageSegmentation">Image Segmentation</a> demonstrates a Python script that converts the PyTorch <a href="https://pytorch.org/hub/pytorch_vision_deeplabv3_resnet101/">DeepLabV3</a> model for mobile apps to use and an iOS app that uses the model to segment images.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-dc96ea3a-83b3-4625-ab91-f3c819fb359c">
		
	Object Detection</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/ObjectDetection">Object Detection</a> demonstrates how to convert the popular <a href="https://pytorch.org/hub/ultralytics_yolov5/">YOLOv5</a> model and use it on an iOS app that detects objects from pictures in your photos, taken with camera, or with live camera.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-9a865830-2bfd-4e6d-bd9a-c70ec2f77b5e">
		
	Neural Machine Translation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/Seq2SeqNMT">Neural Machine Translation</a> demonstrates how to convert a sequence-to-sequence neural machine translation model trained with the code in the <a href="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html">PyTorch NMT tutorial</a> and use the model in an iOS app to do French-English translation.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-1c683489-9ca4-4b45-a76d-e4643eb6244b">
		
	Question Answering</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/QuestionAnswering">Question Answering</a> demonstrates how to convert a powerful transformer QA model and use the model in an iOS app to answer questions about PyTorch Mobile and more.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading HeadingBlock " id="block-9bd0d87a-4a7a-43d3-ad55-b2ea6c1658a6">
		
	Vision Transformer</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/ViT4MNIST">Vision Transformer</a> demonstrates how to use Facebook’s latest Vision Transformer <a href="https://github.com/facebookresearch/deit">DeiT</a> model to do image classification, and how convert another Vision Transformer model and use it in an iOS app to perform handwritten digit recognition.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-56eed797-80e4-41ed-94cd-2be1963090d0">
		
	Speech recognition</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/SpeechRecognition">Speech Recognition</a> demonstrates how to convert Facebook AI’s wav2vec 2.0, one of the leading models in speech recognition, to TorchScript and how to use the scripted model in an iOS app to perform speech recognition.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-b0ecf12a-6fc9-4ea0-8b39-04fafd00a38f">
		
	Video Classification</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/TorchVideo">TorchVideo</a> demonstrates how to use a pre-trained video classification model, available at the newly released <a href="https://github.com/facebookresearch/pytorchvideo">PyTorchVideo</a>, on iOS to see video classification results, updated per second while the video plays, on tested videos, videos from the Photos library, or even real-time videos.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-1de0d93e-bd1f-4045-8ff1-ac7a6a669cbd">
		
	PYTORCH IOS TUTORIAL AND RECIPES</h2>
	</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-c13174f8-f7f4-4ea4-bae8-57257d48df85">
		
	<a href="https://pytorch.org/tutorials/beginner/deeplabv3_on_ios.html">Image Segmentation DeepLabV3 on iOS</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">A comprehensive step-by-step tutorial on how to prepare and run the PyTorch DeepLabV3 image segmentation model on iOS.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-5ed547b5-7471-4664-aed7-e6a5529b920a">
		
	<a href="https://pytorch.org/tutorials/recipes/mobile_perf.html">PyTorch Mobile Performance Recipes</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">List of recipes for performance optimizations for using PyTorch on Mobile.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-7c16cd86-9785-4c12-80c2-91f9744de820">
		
	<a href="https://pytorch.org/tutorials/recipes/fuse.html">Fuse Modules recipe</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to fuse a list of PyTorch modules into a single module to reduce the model size before quantization.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-f9509266-5807-4e2e-934d-51cf3755b87d">
		
	<a href="https://pytorch.org/tutorials/recipes/quantization.html">Quantization for Mobile Recipe</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to reduce the model size and make it run faster without losing much on accuracy.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-7528cf4a-fcbd-4daf-8a93-158576f41514">
		
	<a href="https://pytorch.org/tutorials/recipes/script_optimized.html">Script and Optimize for Mobile</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to convert the model to TorchScipt and (optional) optimize it for mobile apps.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-ccfe47c2-a024-4ed3-8b82-81af932057da">
		
	<a href="https://pytorch.org/tutorials/recipes/model_preparation_ios.html">Model Preparation for iOS Recipe</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to add the model in an iOS project and use PyTorch pod for iOS.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-94535888-7a56-421e-89ae-0eccbc00b05c">
		
	BUILD PYTORCH IOS LIBRARIES FROM SOURCE</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To track the latest updates for iOS, you can build the PyTorch iOS libraries from the source code.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">git clone --recursive https://github.com/pytorch/pytorch
cd pytorch
# if you are updating an existing checkout
git submodule sync
git submodule update --init --recursive</code></pre>
</div>



<div class="TextBlock is-style-code-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><em>Make sure you have </em><code>cmake</code><em> and Python installed correctly on your local machine. We recommend following the </em><a href="https://github.com/pytorch/pytorch">Pytorch Github page</a><em> to set up the Python development environment</em></p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-32b72a3f-963f-4e92-bcf7-b00021803e4d">
		
	Build LibTorch-Lite for iOS Simulators</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Open terminal and navigate to the PyTorch root directory. Run the following command (if you already build LibTorch-Lite for iOS devices (see below), run <code>rm -rf build_ios</code> first):</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">BUILD_PYTORCH_MOBILE=1 IOS_PLATFORM=SIMULATOR ./scripts/build_ios.sh</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">After the build succeeds, all static libraries and header files will be generated under <code>build_ios/install</code></p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-e8ded4b2-263e-42ac-9926-4d1abe2baa39">
		
	Build LibTorch-Lite for arm64 Devices</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Open terminal and navigate to the PyTorch root directory. Run the following command (if you already build LibTorch-Lite for iOS simulators, run <code>rm -rf build_ios</code> first):</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">BUILD_PYTORCH_MOBILE=1 IOS_ARCH=arm64 ./scripts/build_ios.sh</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">After the build succeeds, all static libraries and header files will be generated under <code>build_ios/install</code></p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-ff7fabb0-9f68-4888-9ee4-5b62e0a02ea7">
		
	XCode Setup</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Open your project in XCode, go to your project Target’s <code>Build Phases</code> &#8211; <code>Link Binaries With Libraries</code>, click the + sign and add all the library files located in <code>build_ios/install/lib</code>. Navigate to the project <code>Build Settings</code>, set the value <strong>Header Search Paths</strong> to <code>build_ios/install/include</code> and <strong>Library Search Paths</strong> to <code>build_ios/install/lib</code>.<br><br>In the build settings, search for <strong>other linker flags</strong>. Add a custom linker flag below</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">-all_load</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To use the custom built libraries the project, replace <code>#import &lt;LibTorch-Lite/LibTorch-Lite.h&gt;</code> (in <code>TorchModule.mm</code>) which is needed when using LibTorch-Lite via Cocoapods with the code below:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">#include &lt;torch/csrc/jit/mobile/import.h&gt;
#include &lt;torch/csrc/jit/mobile/module.h&gt;
#include &lt;torch/script.h&gt;</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Finally, disable bitcode for your target by selecting the Build Settings, searching for <strong>Enable Bitcode</strong>, and set the value to <strong>No</strong>.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-85b44f21-0a02-44e3-88d5-5962a1f7c3b5">
		
	USING THE NIGHTLY PYTORCH IOS LIBRARIES IN COCOAPODS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">If you want to try out the latest features added to PyTorch iOS, you can use the <code>LibTorch-Lite-Nightly</code> pod in your <code>Podfile</code>, it includes the nightly built libraries:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pod 'LibTorch-Lite-Nightly'</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">And then run <code>pod install</code> to add it to your project. If you wish to update the nightly pod to the newer one, you can run <code>pod update</code> to get the latest version. But be aware you may need to build the model used on mobile in the latest PyTorch &#8211; using either the latest PyTorch code or a quick nightly install with commands like <code>pip install --pre torch torchvision -f https://download.pytorch.org/whl/nightly/cpu/torch_nightly.html</code> &#8211; to avoid possible model version mismatch errors when running the model on mobile.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-1d50e90b-6b1e-4fe2-aea0-ed257fd5a34a">
		
	CUSTOM BUILD</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Starting from 1.4.0, PyTorch supports custom build. You can now build the PyTorch library that only contains the operators needed by your model. To do that, follow the steps below</p>
	</div>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">Verify your PyTorch version is 1.4.0 or above. You can do that by checking the value of <code>torch.__version__</code>.								</li>
												<li class="item">To dump the operators in your model, say <code>MobileNetV2</code>, run the following lines of Python code: 								</li>
					</ul>
	</div>
</div>


<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">import torch, yaml
model = torch.jit.load('MobileNetV2.pt')
ops = torch.jit.export_opnames(model)
with open('MobileNetV2.yaml', 'w') as output:
    yaml.dump(ops, output)</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">In the snippet above, you first need to load the ScriptModule. Then, use <code>export_opnames</code> to return a list of operator names of the ScriptModule and its submodules. Lastly, save the result in a yaml file.</p>
	</div>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">To run the iOS build script locally with the prepared yaml list of operators, pass in the yaml file generate from the last step into the environment variable <code>SELECTED_OP_LIST</code>. Also in the arguments, specify <code>BUILD_PYTORCH_MOBILE=1</code> as well as the platform/architechture type. Take the arm64 build for example, the command should be:								</li>
					</ul>
	</div>
</div>


<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">SELECTED_OP_LIST=MobileNetV2.yaml BUILD_PYTORCH_MOBILE=1 IOS_ARCH=arm64 ./scripts/build_ios.sh</code></pre>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">After the build succeeds, you can integrate the result libraries to your project by following the <a href="https://pytorch.org/mobile/ios/#xcode-setup">XCode Setup</a> section above.								</li>
												<li class="item">The last step is to add a single line of C++ code before running <code>forward</code>. This is because by default JIT will do some optimizations on operators (fusion for example), which might break the consistency with the ops we dumped from the model.								</li>
					</ul>
	</div>
</div>


<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">torch::jit::GraphOptimizerEnabledGuard guard(false);</code></pre>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-c084d935-0eff-46f2-a649-466ed954d312">
		
	USE PYTORCH JIT INTERPRETER</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">PyTorch JIT interpreter is the default interpreter before 1.9 (a version of our PyTorch interpreter that is not as size-efficient). It will still be supported in 1.9, and can be used in CocoaPods:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pod 'LibTorch', '~&gt;1.9.0'</code></pre>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-f2287bf8-13c9-4fc7-987e-083b3d155048">
		
	IOS TUTORIALS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Watch the following <a href="https://youtu.be/amTepUIR93k">video</a> as PyTorch Partner Engineer Brad Heintz walks through steps for setting up the PyTorch Runtime for iOS projects:</p>
	</div>
</div>


<div class="YoutubeVideo YoutubeVideo">
	<div class="container">
		<div class="video-wrapper">
			<iframe src="https://www.youtube.com/embed/amTepUIR93k?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
			</iframe>
		</div>
	</div>
</div>




<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The corresponding code can be found <a href="https://github.com/pytorch/workshops/tree/master/PTMobileWalkthruIOS">here</a>.<br><br>Additionally, checkout our <a href="https://pytorch.org/tutorials/recipes/mobile_perf.html">Mobile Performance Recipes</a> which cover how to optimize your model and check if optimizations helped via benchmarking.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3cd7ebb7-5d19-49d1-a381-f82accab0e37">
		
	API DOCS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Currently, the iOS framework uses the Pytorch C++ front-end APIs directly. The C++ document can be found <a href="https://pytorch.org/cppdocs/">here</a>. To learn more about it, we recommend exploring the <a href="https://pytorch.org/tutorials/advanced/cpp_frontend.html">C++ front-end tutorials</a> on PyTorch webpage.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-5e6ecdda-5d23-4f46-a58d-7c4ff3ad58e0">
		
	ISSUES AND CONTRIBUTION</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">If you have any questions or want to contribute to PyTorch, please feel free to drop issues or open a pull request to get in touch.</p>
	</div>
</div>						</div>
					
<div class="jump-list-container">
	<div class="jump-list-mobile-heading-container">
		<h2 class="jump-list-mobile-heading">TABLE OF CONTENTS</h2>
	</div>
	<ul class="jump-list">
				<li>
			<ul class="jump-list-links">
									<li class="jump-list-single">
					
											<a href="#block-3d151b2b-7355-4570-ab5a-99ac27601583" class="jump-link level-1" data-blockid="#block-3d151b2b-7355-4570-ab5a-99ac27601583">
						iOS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-16aa6cb6-39a8-498c-8cf4-e2bdf810ff95" class="jump-link level-1" data-blockid="#block-16aa6cb6-39a8-498c-8cf4-e2bdf810ff95">
						QUICKSTART WITH A HELLO WORLD EXAMPLE						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-73027d8e-0449-43f2-9ab5-4bd78577dd6a" class="jump-link level-1" data-blockid="#block-73027d8e-0449-43f2-9ab5-4bd78577dd6a">
						Model Preparation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-0798c42c-5031-4382-bfcb-a0c27e3bcfd5" class="jump-link level-1" data-blockid="#block-0798c42c-5031-4382-bfcb-a0c27e3bcfd5">
						Install LibTorch-Lite via Cocoapods						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-918a3d1d-3327-4ce0-8264-8c77c9990219" class="jump-link level-1" data-blockid="#block-918a3d1d-3327-4ce0-8264-8c77c9990219">
						Code Walkthrough						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-5f9b5885-e413-4e46-b911-8cc0bc3f4a6b" class="jump-link level-1" data-blockid="#block-5f9b5885-e413-4e46-b911-8cc0bc3f4a6b">
						Image Loading						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-959d41a1-c5fa-4cd6-9780-524c8bba1096" class="jump-link level-1" data-blockid="#block-959d41a1-c5fa-4cd6-9780-524c8bba1096">
						TorchScript Module						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-c96161ee-4ca4-44a4-bf81-4282332d981d" class="jump-link level-1" data-blockid="#block-c96161ee-4ca4-44a4-bf81-4282332d981d">
						Run Inference						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-66cbf17c-2e28-4679-938d-61899ea1d9b7" class="jump-link level-1" data-blockid="#block-66cbf17c-2e28-4679-938d-61899ea1d9b7">
						Collect Results						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-e42b810a-dec4-419e-8e1e-b935eb7e4da1" class="jump-link level-1" data-blockid="#block-e42b810a-dec4-419e-8e1e-b935eb7e4da1">
						PYTORCH DEMO APP						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-83a3168e-f9bd-4531-9a92-a3b65da52e1f" class="jump-link level-1" data-blockid="#block-83a3168e-f9bd-4531-9a92-a3b65da52e1f">
						MORE PYTORCH IOS DEMO APPS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-0feec513-7e2e-4aeb-a433-282255523372" class="jump-link level-1" data-blockid="#block-0feec513-7e2e-4aeb-a433-282255523372">
						Image Segmentation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-dc96ea3a-83b3-4625-ab91-f3c819fb359c" class="jump-link level-1" data-blockid="#block-dc96ea3a-83b3-4625-ab91-f3c819fb359c">
						Object Detection						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-9a865830-2bfd-4e6d-bd9a-c70ec2f77b5e" class="jump-link level-1" data-blockid="#block-9a865830-2bfd-4e6d-bd9a-c70ec2f77b5e">
						Neural Machine Translation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-1c683489-9ca4-4b45-a76d-e4643eb6244b" class="jump-link level-1" data-blockid="#block-1c683489-9ca4-4b45-a76d-e4643eb6244b">
						Question Answering						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-9bd0d87a-4a7a-43d3-ad55-b2ea6c1658a6" class="jump-link level-1" data-blockid="#block-9bd0d87a-4a7a-43d3-ad55-b2ea6c1658a6">
						Vision Transformer						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-56eed797-80e4-41ed-94cd-2be1963090d0" class="jump-link level-1" data-blockid="#block-56eed797-80e4-41ed-94cd-2be1963090d0">
						Speech recognition						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-b0ecf12a-6fc9-4ea0-8b39-04fafd00a38f" class="jump-link level-1" data-blockid="#block-b0ecf12a-6fc9-4ea0-8b39-04fafd00a38f">
						Video Classification						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-1de0d93e-bd1f-4045-8ff1-ac7a6a669cbd" class="jump-link level-1" data-blockid="#block-1de0d93e-bd1f-4045-8ff1-ac7a6a669cbd">
						PYTORCH IOS TUTORIAL AND RECIPES						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-c13174f8-f7f4-4ea4-bae8-57257d48df85" class="jump-link level-1" data-blockid="#block-c13174f8-f7f4-4ea4-bae8-57257d48df85">
						Image Segmentation DeepLabV3 on iOS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-5ed547b5-7471-4664-aed7-e6a5529b920a" class="jump-link level-1" data-blockid="#block-5ed547b5-7471-4664-aed7-e6a5529b920a">
						PyTorch Mobile Performance Recipes						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-7c16cd86-9785-4c12-80c2-91f9744de820" class="jump-link level-1" data-blockid="#block-7c16cd86-9785-4c12-80c2-91f9744de820">
						Fuse Modules recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-f9509266-5807-4e2e-934d-51cf3755b87d" class="jump-link level-1" data-blockid="#block-f9509266-5807-4e2e-934d-51cf3755b87d">
						Quantization for Mobile Recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-7528cf4a-fcbd-4daf-8a93-158576f41514" class="jump-link level-1" data-blockid="#block-7528cf4a-fcbd-4daf-8a93-158576f41514">
						Script and Optimize for Mobile						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-ccfe47c2-a024-4ed3-8b82-81af932057da" class="jump-link level-1" data-blockid="#block-ccfe47c2-a024-4ed3-8b82-81af932057da">
						Model Preparation for iOS Recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-94535888-7a56-421e-89ae-0eccbc00b05c" class="jump-link level-1" data-blockid="#block-94535888-7a56-421e-89ae-0eccbc00b05c">
						BUILD PYTORCH IOS LIBRARIES FROM SOURCE						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-32b72a3f-963f-4e92-bcf7-b00021803e4d" class="jump-link level-1" data-blockid="#block-32b72a3f-963f-4e92-bcf7-b00021803e4d">
						Build LibTorch-Lite for iOS Simulators						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-e8ded4b2-263e-42ac-9926-4d1abe2baa39" class="jump-link level-1" data-blockid="#block-e8ded4b2-263e-42ac-9926-4d1abe2baa39">
						Build LibTorch-Lite for arm64 Devices						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-ff7fabb0-9f68-4888-9ee4-5b62e0a02ea7" class="jump-link level-1" data-blockid="#block-ff7fabb0-9f68-4888-9ee4-5b62e0a02ea7">
						XCode Setup						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-85b44f21-0a02-44e3-88d5-5962a1f7c3b5" class="jump-link level-1" data-blockid="#block-85b44f21-0a02-44e3-88d5-5962a1f7c3b5">
						USING THE NIGHTLY PYTORCH IOS LIBRARIES IN COCOAPO&#8230;						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-1d50e90b-6b1e-4fe2-aea0-ed257fd5a34a" class="jump-link level-1" data-blockid="#block-1d50e90b-6b1e-4fe2-aea0-ed257fd5a34a">
						CUSTOM BUILD						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-c084d935-0eff-46f2-a649-466ed954d312" class="jump-link level-1" data-blockid="#block-c084d935-0eff-46f2-a649-466ed954d312">
						USE PYTORCH JIT INTERPRETER						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-f2287bf8-13c9-4fc7-987e-083b3d155048" class="jump-link level-1" data-blockid="#block-f2287bf8-13c9-4fc7-987e-083b3d155048">
						IOS TUTORIALS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3cd7ebb7-5d19-49d1-a381-f82accab0e37" class="jump-link level-1" data-blockid="#block-3cd7ebb7-5d19-49d1-a381-f82accab0e37">
						API DOCS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-5e6ecdda-5d23-4f46-a58d-7c4ff3ad58e0" class="jump-link level-1" data-blockid="#block-5e6ecdda-5d23-4f46-a58d-7c4ff3ad58e0">
						ISSUES AND CONTRIBUTION						</a>
															</li>
							</ul>
		</li>
	</ul>
</div>
				</div>
							</li>
								<li class="tab-content ">
									<div class="two-column-container">
						<div class="content">
							<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-dd10b963-2b34-4408-ba37-49b2d6d99ec3">
		
	Android</h2>
	</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3f34275f-d11d-4ce4-a6b8-9257b3f8e3c3">
		
	QUICKSTART WITH A HELLOWORLD EXAMPLE</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/HelloWorldApp">HelloWorld</a> is a simple image classification application that demonstrates how to use PyTorch Android API. This application runs TorchScript serialized TorchVision pretrained resnet18 model on static image which is packaged inside the app as android asset.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-708b0333-b952-4008-895b-533b6e5ba722">
		
	1. Model Preparation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Let’s start with model preparation. If you are familiar with PyTorch, you probably should already know how to train and save your model. In case you don’t, we are going to use a pre-trained image classification model (<a href="https://pytorch.org/hub/pytorch_vision_mobilenet_v2/">MobileNetV2</a>). To install it, run the command below:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pip install torchvision</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To serialize the model you can use python <a href="https://github.com/pytorch/android-demo-app/blob/master/HelloWorldApp/trace_model.py">script</a> in the root folder of HelloWorld app:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">import torch
import torchvision
from torch.utils.mobile_optimizer import optimize_for_mobile

model = torchvision.models.mobilenet_v2(pretrained=True)
model.eval()
example = torch.rand(1, 3, 224, 224)
traced_script_module = torch.jit.trace(model, example)
traced_script_module_optimized = optimize_for_mobile(traced_script_module)
traced_script_module_optimized._save_for_lite_interpreter("app/src/main/assets/model.ptl")</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">If everything works well, we should have our model &#8211; <code>model.ptl</code> generated in the assets folder of android application. That will be packaged inside android application as <code>asset</code> and can be used on the device.<br><br>More details about TorchScript you can find in <a href="https://pytorch.org/docs/stable/jit.html">tutorials on pytorch.org</a></p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-8774d715-5587-44c8-9ca2-e0b0d887e226">
		
	2. Cloning from github</h3>
	</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">git clone https://github.com/pytorch/android-demo-app.git
cd HelloWorldApp</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">If <a href="https://developer.android.com/studio/index.html#command-tools">Android SDK</a> and <a href="https://developer.android.com/ndk/downloads">Android NDK</a> are already installed you can install this application to the connected android device or emulator with:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">./gradlew installDebug</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">We recommend you to open this project in <a href="https://developer.android.com/studio">Android Studio 3.5.1+</a>. At the moment PyTorch Android and demo applications use <a href="https://developer.android.com/studio/releases/gradle-plugin#3-5-0">android gradle plugin of version 3.5.0</a>, which is supported only by Android Studio version 3.5.1 and higher. Using Android Studio you will be able to install Android NDK and Android SDK with Android Studio UI.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-405699da-5447-4909-965e-ed3fcb40a6e4">
		
	3. Gradle dependencies</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Pytorch android is added to the HelloWorld as <a href="https://github.com/pytorch/android-demo-app/blob/master/HelloWorldApp/app/build.gradle#L28-L29">gradle dependencies</a> in build.gradle:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">repositories {
    jcenter()
}

dependencies {
    implementation 'org.pytorch:pytorch_android_lite:1.9.0'
    implementation 'org.pytorch:pytorch_android_torchvision:1.9.0'
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Where <code>org.pytorch:pytorch_android</code> is the main dependency with PyTorch Android API, including libtorch native library for all 4 android abis (armeabi-v7a, arm64-v8a, x86, x86_64). Further in this doc you can find how to rebuild it only for specific list of android abis.<br><br><code>org.pytorch:pytorch_android_torchvision</code> &#8211; additional library with utility functions for converting <code>android.media.Image</code> and <code>android.graphics.Bitmap</code> to tensors.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-0d304981-7a55-4f7d-9166-c0d613b13775">
		
	4. Reading image from Android Asset</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">All the logic happens in <a href="https://github.com/pytorch/android-demo-app/blob/master/HelloWorldApp/app/src/main/java/org/pytorch/helloworld/MainActivity.java#L31-L69"><code>org.pytorch.helloworld.MainActivity</code></a>. As a first step we read <code>image.jpg</code> to <code>android.graphics.Bitmap</code> using the standard Android API.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">Bitmap bitmap = BitmapFactory.decodeStream(getAssets().open("image.jpg"));</code></pre>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-03e7301c-e4da-4657-87d1-74ce72b56ff5">
		
	5. Loading Mobile Module</h3>
	</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">Module module = Module.load(assetFilePath(this, "model.ptl"));</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><code>org.pytorch.Module</code> represents <code>torch::jit::mobile::Module</code> that can be loaded with <code>load</code> method specifying file path to the serialized to file model.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-8e367e82-eda0-4ccf-b792-5e0c4b2989cc">
		
	6. Preparing Input</h3>
	</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">Tensor inputTensor = TensorImageUtils.bitmapToFloat32Tensor(bitmap,
    TensorImageUtils.TORCHVISION_NORM_MEAN_RGB, TensorImageUtils.TORCHVISION_NORM_STD_RGB);</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><code>org.pytorch.torchvision.TensorImageUtils</code> is part of <code>org.pytorch:pytorch_android_torchvision</code> library. The <code>TensorImageUtils#bitmapToFloat32Tensor</code> method creates tensors in the <a href="https://pytorch.org/docs/stable/torchvision/models.html">torchvision format</a> using <code>android.graphics.Bitmap</code> as a source.</p>
	</div>
</div>



<div class="TextBlock is-style-code-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><em>All pre-trained models expect input images normalized in the same way, i.e. mini-batches of 3-channel RGB images of shape (3 x H x W), where H and W are expected to be at least 224. The images have to be loaded in to a range of </em><code>[0, 1]</code><em> and then normalized using </em><code>mean = [0.485, 0.456, 0.406]</code><em> and </em><code>std = [0.229, 0.224, 0.225]</code></p>
	</div>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><code>inputTensor</code>’s shape is <code>1x3xHxW</code>, where <code>H</code> and <code>W</code> are bitmap height and width appropriately.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-e618d1ec-e8eb-43c1-bdb0-54759133f6fc">
		
	7. Run Inference</h3>
	</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">Tensor outputTensor = module.forward(IValue.from(inputTensor)).toTensor();
float[] scores = outputTensor.getDataAsFloatArray();</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><code>org.pytorch.Module.forward</code> method runs loaded module’s <code>forward</code> method and gets result as <code>org.pytorch.Tensor</code> outputTensor with shape <code>1x1000</code>.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-17dc762b-ecbb-454d-99b9-d3ec282043bb">
		
	8. Processing results</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Its content is retrieved using <code>org.pytorch.Tensor.getDataAsFloatArray()</code> method that returns java array of floats with scores for every image net class.<br><br>After that we just find index with maximum score and retrieve predicted class name from <code>ImageNetClasses.IMAGENET_CLASSES</code> array that contains all ImageNet classes.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">float maxScore = -Float.MAX_VALUE;
int maxScoreIdx = -1;
for (int i = 0; i &lt; scores.length; i++) {
  if (scores[i] &gt; maxScore) {
    maxScore = scores[i];
    maxScoreIdx = i;
  }
}
String className = ImageNetClasses.IMAGENET_CLASSES[maxScoreIdx];</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">In the following sections you can find detailed explanations of PyTorch Android API, code walk through for a bigger <a href="https://github.com/pytorch/android-demo-app/tree/master/PyTorchDemoApp">demo application</a>, implementation details of the API, how to customize and build it from source.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3d843c4f-f59c-45df-b640-cbb0e08dbfbd">
		
	PYTORCH DEMO APPLICATION</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">We have also created another more complex PyTorch Android demo application that does image classification from camera output and text classification in the <a href="https://github.com/pytorch/android-demo-app/tree/master/PyTorchDemoApp">same github repo</a>.<br><br>To get device camera output it uses <a href="https://developer.android.com/training/camerax">Android CameraX API</a>. All the logic that works with CameraX is separated to <a href="https://github.com/pytorch/android-demo-app/blob/master/PyTorchDemoApp/app/src/main/java/org/pytorch/demo/vision/AbstractCameraXActivity.java"><code>org.pytorch.demo.visionWe have also created another more complex PyTorch Android demo application that does image classification from camera output and text classification in the <a href="https://github.com/pytorch/android-demo-app/tree/master/PyTorchDemoApp">same github repo</a>.</code></a><br><a href="https://github.com/pytorch/android-demo-app/blob/master/PyTorchDemoApp/app/src/main/java/org/pytorch/demo/vision/AbstractCameraXActivity.java"><code><br>To get device camera output it uses <a href="https://developer.android.com/training/camerax">Android CameraX API</a>. All the logic that works with CameraX is separated to <a href="https://github.com/pytorch/android-demo-app/blob/master/PyTorchDemoApp/app/src/main/java/org/pytorch/demo/vision/AbstractCameraXActivity.java"><code>org.pytorch.demo.vision.AbstractCameTo get device camera output it uses <a href="https://developer.android.com/training/camerax">Android CameraX API</a>. All the logic that works with CameraX is separated to <a href="https://github.com/pytorch/android-demo-app/blob/master/PyTorchDemoApp/app/src/main/java/org/pytorch/demo/vision/AbstractCameraXActivity.java"><code>org.pytorch.demo.vision.AbstractCameraXActivity</code></a> class.</code></a></code></a></p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">void setupCameraX() {
    final PreviewConfig previewConfig = new PreviewConfig.Builder().build();
    final Preview preview = new Preview(previewConfig);
    preview.setOnPreviewOutputUpdateListener(output -&gt; mTextureView.setSurfaceTexture(output.getSurfaceTexture()));

    final ImageAnalysisConfig imageAnalysisConfig =
        new ImageAnalysisConfig.Builder()
            .setTargetResolution(new Size(224, 224))
            .setCallbackHandler(mBackgroundHandler)
            .setImageReaderMode(ImageAnalysis.ImageReaderMode.ACQUIRE_LATEST_IMAGE)
            .build();
    final ImageAnalysis imageAnalysis = new ImageAnalysis(imageAnalysisConfig);
    imageAnalysis.setAnalyzer(
        (image, rotationDegrees) -&gt; {
          analyzeImage(image, rotationDegrees);
        });

    CameraX.bindToLifecycle(this, preview, imageAnalysis);
  }

  void analyzeImage(android.media.Image, int rotationDegrees)</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Where the <code>analyzeImage</code> method process the camera output, <code>android.media.Image</code>.<br><br>It uses the aforementioned <a href="https://github.com/pytorch/pytorch/blob/master/android/pytorch_android_torchvision/src/main/java/org/pytorch/torchvision/TensorImageUtils.java#L90"><code>TensorImageUtils.imageYUV420CenterCropToFloat32Tensor</code></a> method to convert <code>android.media.Image</code> in <code>YUV420</code> format to input tensor.<br><br>After getting predicted scores from the model it finds top K classes with the highest scores and shows on the UI.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-da9fb6fe-4006-4f6d-af86-51c1e92982f4">
		
	Language Processing Example</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Another example is natural language processing, based on an LSTM model, trained on a reddit comments dataset. The logic happens in <a href="https://github.com/pytorch/android-demo-app/blob/master/PyTorchDemoApp/app/src/main/java/org/pytorch/demo/nlp/TextClassificationActivity.java"><code>TextClassificattionActivity</code></a>.<br><br>Result class names are packaged inside the TorchScript model and initialized just after initial module initialization. The module has a <code>get_classes</code> method that returns <code>List[str]</code>, which can be called using method <code>Module.runMethod(methodName)</code>:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">  mModule = Module.load(moduleFileAbsoluteFilePath);
    IValue getClassesOutput = mModule.runMethod("get_classes");</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The returned <code>IValue</code> can be converted to java array of <code>IValue</code> using <code>IValue.toList()</code> and processed to an array of strings using <code>IValue.toStr()</code>:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">    IValue[] classesListIValue = getClassesOutput.toList();
    String[] moduleClasses = new String[classesListIValue.length];
    int i = 0;
    for (IValue iv : classesListIValue) {
      moduleClasses[i++] = iv.toStr();
    }</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Entered text is converted to java array of bytes with <code>UTF-8</code> encoding. <code>Tensor.fromBlobUnsigned</code> creates tensor of <code>dtype=uint8</code> from that array of bytes.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">byte[] bytes = text.getBytes(Charset.forName("UTF-8"));
final long[] shape = new long[]{1, bytes.length};
final Tensor inputTensor = Tensor.fromBlobUnsigned(bytes, shape);</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Running inference of the model is similar to previous examples:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">Tensor outputTensor = mModule.forward(IValue.from(inputTensor)).toTensor()</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">After that, the code processes the output, finding classes with the highest scores.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-2ab9801a-ab08-4315-9b4d-0a765a9ae512">
		
	MORE PYTORCH ANDROID DEMO APPS</h3>
	</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-f6d48450-34d4-4f98-88da-c4cc2e174bf6">
		
	D2go</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/D2Go">D2Go</a> demonstrates a Python script that creates the much lighter and much faster Facebook <a href="https://github.com/facebookresearch/d2go">D2Go</a> model that is powered by PyTorch 1.8, torchvision 0.9, and Detectron2 with built-in SOTA networks for mobile, and an Android app that uses it to detect objects from pictures in your photos, taken with camera, or with live camera. This demo app also shows how to use the native pre-built torchvision-ops library.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-9557a72e-f61e-4708-93e6-f367be95c523">
		
	Image Segmentation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/ImageSegmentation">Image Segmentation</a> demonstrates a Python script that converts the PyTorch <a href="https://pytorch.org/hub/pytorch_vision_deeplabv3_resnet101/">DeepLabV3</a> model and an Android app that uses the model to segment images.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-a2ae4f06-a4b0-4174-8fa2-1a6af8fc560e">
		
	Object Detection</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/ObjectDetection">Object Detection</a> demonstrates how to convert the popular <a href="https://pytorch.org/hub/ultralytics_yolov5/">YOLOv5</a> model and use it in an Android app that detects objects from pictures in your photos, taken with camera, or with live camera.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-32b33535-87fa-4c50-b5d2-1f1acdaae257">
		
	Neural Machine Translation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/Seq2SeqNMT">Neural Machine Translation</a> demonstrates how to convert a sequence-to-sequence neural machine translation model trained with the code in the <a href="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html">PyTorch NMT tutorial</a> and use the model in an Android app to do French-English translation.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-402abc6f-9c91-4f28-9845-e83ba5e1616b">
		
	Question Answering</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/QuestionAnswering">Question Answering</a> demonstrates how to convert a powerful transformer QA model and use the model in an Android app to answer questions about PyTorch Mobile and more.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-5234adb7-21ac-479a-9dad-068667d0189d">
		
	Vision Transformer</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/ViT4MNIST">Vision Transformer</a> demonstrates how to use Facebook’s latest Vision Transformer <a href="https://github.com/facebookresearch/deit">DeiT</a> model to do image classification, and how convert another Vision Transformer model and use it in an Android app to perform handwritten digit recognition.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-b36f68e6-4864-4f50-9b4f-6fc668155c0d">
		
	Speech recognition</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/SpeechRecognition">Speech Recognition</a> demonstrates how to convert Facebook AI’s wav2vec 2.0, one of the leading models in speech recognition, to TorchScript and how to use the scripted model in an Android app to perform speech recognition.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-53aaede6-25f5-40ab-a710-7815b422910b">
		
	Video Classification</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/TorchVideo">TorchVideo</a> demonstrates how to use a pre-trained video classification model, available at the newly released <a href="https://github.com/facebookresearch/pytorchvideo">PyTorchVideo</a>, on Android to see video classification results, updated per second while the video plays, on tested videos, videos from the Photos library, or even real-time videos.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-508ff49b-9add-41b4-8cc5-dbb9c24bc64c">
		
	PYTORCH ANDROID TUTORIAL AND RECIPES</h2>
	</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-0e0bbd72-d3e6-400c-bb5f-f2a93245076e">
		
	<a href="https://pytorch.org/tutorials/beginner/deeplabv3_on_android.html">Image Segmentation DeepLabV3 on Android</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">A comprehensive step-by-step tutorial on how to prepare and run the PyTorch DeepLabV3 image segmentation model on Android.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-cac30e64-2655-4c9e-9d51-077b0b8827a6">
		
	<a href="https://pytorch.org/tutorials/recipes/mobile_perf.html">PyTorch Mobile Performance Recipes</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">List of recipes for performance optimizations for using PyTorch on Mobile.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-63edae1a-5eb5-45bf-aeb6-c459705ac226">
		
	<a href="https://pytorch.org/tutorials/recipes/android_native_app_with_custom_op.html">Making Android Native Application That Uses PyTorch Android Prebuilt Libraries</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to make Android application from the scratch that uses LibTorch C++ API and uses TorchScript model with custom C++ operator.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-a6b93a2b-feda-4b3f-a392-df90b0649bfa">
		
	<a href="https://pytorch.org/tutorials/recipes/fuse.html">Fuse Modules recipe</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to fuse a list of PyTorch modules into a single module to reduce the model size before quantization.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-5a6a2240-0c30-4581-92f2-d1cc61f29e3e">
		
	<a href="https://pytorch.org/tutorials/recipes/quantization.html">Quantization for Mobile Recipe</a><br>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to reduce the model size and make it run faster without losing much on accuracy.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-fc788b7b-7e12-4995-ab75-e3c54be45d02">
		
	<a href="https://pytorch.org/tutorials/recipes/script_optimized.html">Script and Optimize for Mobile</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to convert the model to TorchScipt and (optional) optimize it for mobile apps.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-2e8c7edc-b872-49f2-abf9-67ae7b5101d3">
		
	<a href="https://pytorch.org/tutorials/recipes/model_preparation_android.html">Model Preparation for Android Recipe</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to add the model in an Android project and use the PyTorch library for Android.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-c6846267-7870-4f5d-9a0e-1e5e2582497f">
		
	BUILDING PYTORCH ANDROID FROM SOURCE</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">In some cases you might want to use a local build of PyTorch android, for example you may build custom LibTorch binary with another set of operators or to make local changes, or try out the latest PyTorch code.<br><br>For this you can use <code>./scripts/build_pytorch_android.sh</code> script.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">git clone https://github.com/pytorch/pytorch.git
cd pytorch
sh ./scripts/build_pytorch_android.sh</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The workflow contains several steps:</p>
	</div>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"></p>
	</div>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">Build libtorch for android for all 4 android abis (armeabi-v7a, arm64-v8a, x86, x86_64)								</li>
												<li class="item">Create symbolic links to the results of those builds:  <code>android/pytorch_android/src/main/jniLibs/${abi}</code> to the directory with output libraries <code>android/pytorch_android/src/main/cpp/libtorch_include/${abi}</code> to the directory with headers. These directories are used to build <code>libpytorch_jni.so</code> library, as part of the <code>pytorch_android-release.aar</code> bundle, that will be loaded on android device.								</li>
												<li class="item">And finally run <code>gradle</code> in <code>android/pytorch_android</code> directory with task <code>assembleRelease</code>								</li>
					</ul>
	</div>
</div>




<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Script requires that Android SDK, Android NDK, Java SDK, and gradle are installed. They are specified as environment variables:<br><br><code>ANDROID_HOME</code> &#8211; path to <a href="https://developer.android.com/studio/command-line/sdkmanager.html">Android SDK</a><br><code>ANDROID_NDK</code> &#8211; path to <a href="https://developer.android.com/studio/projects/install-ndk">Android NDK</a><br><code>GRADLE_HOME</code> &#8211; path to <a href="https://gradle.org/releases/">gradle</a><br><code>JAVA_HOME</code> &#8211; path to <a href="https://www.oracle.com/java/technologies/javase-downloads.html#javasejdk">JAVA JDK</a><br>After successful build, you should see the result as aar file:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">$ find android -type f -name *aar
android/pytorch_android/build/outputs/aar/pytorch_android-release.aar
android/pytorch_android_torchvision/build/outputs/aar/pytorch_android_torchvision-release.aar</code></pre>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3dce6560-3ab4-4bb8-b532-64492e1b2028">
		
	USING THE PYTORCH ANDROID LIBRARIES BUILT FROM SOURCE OR NIGHTLY</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">First add the two aar files built above, or downloaded from the nightly built PyTorch Android repos at <a href="https://oss.sonatype.org/#nexus-search;quick~pytorch_android">here</a> and <a href="https://oss.sonatype.org/#nexus-search;quick~torchvision_android">here</a>, to the Android project’s <code>lib</code> folder, then add in the project’s app <code>build.gradle</code> file:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">allprojects {
    repositories {
        flatDir {
            dirs 'libs'
        }
    }
}

dependencies {

    // if using the libraries built from source
    implementation(name:'pytorch_android-release', ext:'aar')
    implementation(name:'pytorch_android_torchvision-release', ext:'aar')

    // if using the nightly built libraries downloaded above, for example the 1.8.0-snapshot on Jan. 21, 2021
    // implementation(name:'pytorch_android-1.8.0-20210121.092759-172', ext:'aar')
    // implementation(name:'pytorch_android_torchvision-1.8.0-20210121.092817-173', ext:'aar')

    ...
    implementation 'com.android.support:appcompat-v7:28.0.0'
    implementation 'com.facebook.fbjni:fbjni-java-only:0.0.3'
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Also we have to add all transitive dependencies of our aars. As <code>pytorch_android</code> depends on <code>com.android.support:appcompat-v7:28.0.0</code> or <code>androidx.appcompat:appcompat:1.2.0</code>, we need to one of them. (In case of using maven dependencies they are added automatically from <code>pom.xml</code>).</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3584f1c7-fe59-4ce1-9d7b-9aa2de391f2c">
		
	USING THE NIGHTLY PYTORCH ANDROID LIBRARIES</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Other than using the aar files built from source or downloaded from the links in the previous section, you can also use the nightly built Android PyTorch and TorchVision libraries by adding in your app <code>build.gradle</code> file the maven url and the nightly libraries implementation as follows:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">repositories {
    maven {
        url "https://oss.sonatype.org/content/repositories/snapshots"
    }
}

dependencies {
    ...
    implementation 'org.pytorch:pytorch_android:1.8.0-SNAPSHOT'
    implementation 'org.pytorch:pytorch_android_torchvision:1.8.0-SNAPSHOT'
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">This is the easiest way to try out the latest PyTorch code and the Android libraries, if you do not need to make any local changes. But be aware you may need to build the model used on mobile in the latest PyTorch &#8211; using either the latest PyTorch code or a quick nightly install with commands like <code>pip install --pre torch torchvision -f https://download.pytorch.org/whl/nightly/cpu/torch_nightly.html</code> &#8211; to avoid possible model version mismatch errors when running the model on mobile.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3282f9d8-8e8a-4432-9f0b-dd13c2c186df">
		
	CUSTOM BUILD</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To reduce the size of binaries you can do custom build of PyTorch Android with only set of operators required by your model. This includes two steps: preparing the list of operators from your model, rebuilding pytorch android with specified list.</p>
	</div>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">Verify your PyTorch version is 1.4.0 or above. You can do that by checking the value of <code>torch.__version__</code>.								</li>
												<li class="item">Preparation of the list of operators								</li>
					</ul>
	</div>
</div>




<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">List of operators of your serialized torchscript model can be prepared in yaml format using python api function <code>torch.jit.export_opnames()</code>. To dump the operators in your model, say <code>MobileNetV2</code>, run the following lines of Python code:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash"># Dump list of operators used by MobileNetV2:
import torch, yaml
model = torch.jit.load('MobileNetV2.pt')
ops = torch.jit.export_opnames(model)
with open('MobileNetV2.yaml', 'w') as output:
    yaml.dump(ops, output)</code></pre>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">Building PyTorch Android with prepared operators list.								</li>
					</ul>
	</div>
</div>




<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To build PyTorch Android with the prepared yaml list of operators, specify it in the environment variable <code>SELECTED_OP_LIST</code>. Also in the arguments, specify which Android ABIs it should build; by default it builds all 4 Android ABIs.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash"># Build PyTorch Android library customized for MobileNetV2:
SELECTED_OP_LIST=MobileNetV2.yaml scripts/build_pytorch_android.sh arm64-v8a</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">After successful build you can integrate the result aar files to your android gradle project, following the steps from previous section of this tutorial (Building PyTorch Android from Source).</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-81f50b93-f6bf-4903-9406-5a6bee3f8c3a">
		
	USE PYTORCH JIT INTERPRETER</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">PyTorch JIT interpreter is the default interpreter before 1.9 (a version of our PyTorch interpreter that is not as size-efficient). It will still be supported in 1.9, and can be used via <code>build.gradle</code>:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">repositories {
    jcenter()
}

dependencies {
    implementation 'org.pytorch:pytorch_android:1.9.0'
    implementation 'org.pytorch:pytorch_android_torchvision:1.9.0'
}</code></pre>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-7dffeb3c-e1b1-4988-b138-05dcd493e64c">
		
	ANDROID TUTORIALS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Watch the following <a href="https://youtu.be/5Lxuu16_28o">video</a> as PyTorch Partner Engineer Brad Heintz walks through steps for setting up the PyTorch Runtime for Android projects:</p>
	</div>
</div>


<div class="YoutubeVideo YoutubeVideo">
	<div class="container">
		<div class="video-wrapper">
			<iframe src="https://www.youtube.com/embed/5Lxuu16_28o?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
			</iframe>
		</div>
	</div>
</div>




<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The corresponding code can be found <a href="https://github.com/pytorch/workshops/tree/master/PTMobileWalkthruAndroid">here</a>.<br><br>Checkout our <a href="https://pytorch.org/tutorials/recipes/mobile_perf.html">Mobile Performance Recipes</a> which cover how to optimize your model and check if optimizations helped via benchmarking.<br><br>In addition, follow this recipe to learn how to <a href="https://pytorch.org/tutorials/recipes/android_native_app_with_custom_op.html">make Native Android Application that use PyTorch prebuilt libraries</a>.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-85ac6da6-36af-4028-9f93-c6cb8fd4da1d">
		
	API DOCS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">You can find more details about the PyTorch Android API in the <a href="https://pytorch.org/javadoc/">Javadoc</a>.</p>
	</div>
</div>						</div>
					
<div class="jump-list-container">
	<div class="jump-list-mobile-heading-container">
		<h2 class="jump-list-mobile-heading">TABLE OF CONTENTS</h2>
	</div>
	<ul class="jump-list">
					<li class="jump-list-title">
			<h3 class="jump-list-heading">Shortcuts</h3>
			</li>
				<li>
			<ul class="jump-list-links">
									<li class="jump-list-single">
					
											<a href="#block-dd10b963-2b34-4408-ba37-49b2d6d99ec3" class="jump-link level-1" data-blockid="#block-dd10b963-2b34-4408-ba37-49b2d6d99ec3">
						Android						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3f34275f-d11d-4ce4-a6b8-9257b3f8e3c3" class="jump-link level-1" data-blockid="#block-3f34275f-d11d-4ce4-a6b8-9257b3f8e3c3">
						QUICKSTART WITH A HELLOWORLD EXAMPLE						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-708b0333-b952-4008-895b-533b6e5ba722" class="jump-link level-1" data-blockid="#block-708b0333-b952-4008-895b-533b6e5ba722">
						1. Model Preparation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-8774d715-5587-44c8-9ca2-e0b0d887e226" class="jump-link level-1" data-blockid="#block-8774d715-5587-44c8-9ca2-e0b0d887e226">
						2. Cloning from github						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-405699da-5447-4909-965e-ed3fcb40a6e4" class="jump-link level-1" data-blockid="#block-405699da-5447-4909-965e-ed3fcb40a6e4">
						3. Gradle dependencies						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-0d304981-7a55-4f7d-9166-c0d613b13775" class="jump-link level-1" data-blockid="#block-0d304981-7a55-4f7d-9166-c0d613b13775">
						4. Reading image from Android Asset						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-03e7301c-e4da-4657-87d1-74ce72b56ff5" class="jump-link level-1" data-blockid="#block-03e7301c-e4da-4657-87d1-74ce72b56ff5">
						5. Loading Mobile Module						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-8e367e82-eda0-4ccf-b792-5e0c4b2989cc" class="jump-link level-1" data-blockid="#block-8e367e82-eda0-4ccf-b792-5e0c4b2989cc">
						6. Preparing Input						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-e618d1ec-e8eb-43c1-bdb0-54759133f6fc" class="jump-link level-1" data-blockid="#block-e618d1ec-e8eb-43c1-bdb0-54759133f6fc">
						7. Run Inference						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-17dc762b-ecbb-454d-99b9-d3ec282043bb" class="jump-link level-1" data-blockid="#block-17dc762b-ecbb-454d-99b9-d3ec282043bb">
						8. Processing results						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3d843c4f-f59c-45df-b640-cbb0e08dbfbd" class="jump-link level-1" data-blockid="#block-3d843c4f-f59c-45df-b640-cbb0e08dbfbd">
						PYTORCH DEMO APPLICATION						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-da9fb6fe-4006-4f6d-af86-51c1e92982f4" class="jump-link level-1" data-blockid="#block-da9fb6fe-4006-4f6d-af86-51c1e92982f4">
						Language Processing Example						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-2ab9801a-ab08-4315-9b4d-0a765a9ae512" class="jump-link level-1" data-blockid="#block-2ab9801a-ab08-4315-9b4d-0a765a9ae512">
						MORE PYTORCH ANDROID DEMO APPS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-f6d48450-34d4-4f98-88da-c4cc2e174bf6" class="jump-link level-1" data-blockid="#block-f6d48450-34d4-4f98-88da-c4cc2e174bf6">
						D2go						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-9557a72e-f61e-4708-93e6-f367be95c523" class="jump-link level-1" data-blockid="#block-9557a72e-f61e-4708-93e6-f367be95c523">
						Image Segmentation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-a2ae4f06-a4b0-4174-8fa2-1a6af8fc560e" class="jump-link level-1" data-blockid="#block-a2ae4f06-a4b0-4174-8fa2-1a6af8fc560e">
						Object Detection						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-32b33535-87fa-4c50-b5d2-1f1acdaae257" class="jump-link level-1" data-blockid="#block-32b33535-87fa-4c50-b5d2-1f1acdaae257">
						Neural Machine Translation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-402abc6f-9c91-4f28-9845-e83ba5e1616b" class="jump-link level-1" data-blockid="#block-402abc6f-9c91-4f28-9845-e83ba5e1616b">
						Question Answering						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-5234adb7-21ac-479a-9dad-068667d0189d" class="jump-link level-1" data-blockid="#block-5234adb7-21ac-479a-9dad-068667d0189d">
						Vision Transformer						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-b36f68e6-4864-4f50-9b4f-6fc668155c0d" class="jump-link level-1" data-blockid="#block-b36f68e6-4864-4f50-9b4f-6fc668155c0d">
						Speech recognition						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-53aaede6-25f5-40ab-a710-7815b422910b" class="jump-link level-1" data-blockid="#block-53aaede6-25f5-40ab-a710-7815b422910b">
						Video Classification						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-508ff49b-9add-41b4-8cc5-dbb9c24bc64c" class="jump-link level-1" data-blockid="#block-508ff49b-9add-41b4-8cc5-dbb9c24bc64c">
						PYTORCH ANDROID TUTORIAL AND RECIPES						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-0e0bbd72-d3e6-400c-bb5f-f2a93245076e" class="jump-link level-1" data-blockid="#block-0e0bbd72-d3e6-400c-bb5f-f2a93245076e">
						Image Segmentation DeepLabV3 on Android						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-cac30e64-2655-4c9e-9d51-077b0b8827a6" class="jump-link level-1" data-blockid="#block-cac30e64-2655-4c9e-9d51-077b0b8827a6">
						PyTorch Mobile Performance Recipes						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-63edae1a-5eb5-45bf-aeb6-c459705ac226" class="jump-link level-1" data-blockid="#block-63edae1a-5eb5-45bf-aeb6-c459705ac226">
						Making Android Native Application That Uses PyTorc&#8230;						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-a6b93a2b-feda-4b3f-a392-df90b0649bfa" class="jump-link level-1" data-blockid="#block-a6b93a2b-feda-4b3f-a392-df90b0649bfa">
						Fuse Modules recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-5a6a2240-0c30-4581-92f2-d1cc61f29e3e" class="jump-link level-1" data-blockid="#block-5a6a2240-0c30-4581-92f2-d1cc61f29e3e">
						Quantization for Mobile Recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-fc788b7b-7e12-4995-ab75-e3c54be45d02" class="jump-link level-1" data-blockid="#block-fc788b7b-7e12-4995-ab75-e3c54be45d02">
						Script and Optimize for Mobile						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-2e8c7edc-b872-49f2-abf9-67ae7b5101d3" class="jump-link level-1" data-blockid="#block-2e8c7edc-b872-49f2-abf9-67ae7b5101d3">
						Model Preparation for Android Recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-c6846267-7870-4f5d-9a0e-1e5e2582497f" class="jump-link level-1" data-blockid="#block-c6846267-7870-4f5d-9a0e-1e5e2582497f">
						BUILDING PYTORCH ANDROID FROM SOURCE						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3dce6560-3ab4-4bb8-b532-64492e1b2028" class="jump-link level-1" data-blockid="#block-3dce6560-3ab4-4bb8-b532-64492e1b2028">
						USING THE PYTORCH ANDROID LIBRARIES BUILT FROM SOU&#8230;						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3584f1c7-fe59-4ce1-9d7b-9aa2de391f2c" class="jump-link level-1" data-blockid="#block-3584f1c7-fe59-4ce1-9d7b-9aa2de391f2c">
						USING THE NIGHTLY PYTORCH ANDROID LIBRARIES						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3282f9d8-8e8a-4432-9f0b-dd13c2c186df" class="jump-link level-1" data-blockid="#block-3282f9d8-8e8a-4432-9f0b-dd13c2c186df">
						CUSTOM BUILD						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-81f50b93-f6bf-4903-9406-5a6bee3f8c3a" class="jump-link level-1" data-blockid="#block-81f50b93-f6bf-4903-9406-5a6bee3f8c3a">
						USE PYTORCH JIT INTERPRETER						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-7dffeb3c-e1b1-4988-b138-05dcd493e64c" class="jump-link level-1" data-blockid="#block-7dffeb3c-e1b1-4988-b138-05dcd493e64c">
						ANDROID TUTORIALS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-85ac6da6-36af-4028-9f93-c6cb8fd4da1d" class="jump-link level-1" data-blockid="#block-85ac6da6-36af-4028-9f93-c6cb8fd4da1d">
						API DOCS						</a>
															</li>
							</ul>
		</li>
	</ul>
</div>
				</div>
							</li>
								</ul>
</div>



<div class="Section">
			<div class="">
<h3 class="HeadingBlock is-style-subheading " id="block-">
		
	IOS</h3>
	</div>		

<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To get started with PyTorch on iOS, we recommend exploring the following <a href="#">HelloWorld</a>.</p>
	</div>
</div>
</div>




<div class="Section">
			<div class="">
<h3 class="HeadingBlock is-style-subheading " id="block-">
		
	QUICKSTART WITH A HELLO WORLD EXAMPLE</h3>
	</div>		

<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">HelloWorld is a simple image classification application that demonstrates how to use PyTorch C++ libraries on iOS. The code is written in Swift and uses Objective-C as a bridge.<br></p>
	</div>
</div>
<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-314a523a-45e9-453f-9743-f7932095c6cf">
		
	Model Preparation</h3>
	</div>


<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Let’s start with model preparation. If you are familiar with PyTorch, you probably should already know how to train and save your model. In case you don’t, we are going to use a pre-trained image classification model &#8211; MobileNet v2, which is already packaged in TorchVision. To install it, run the command below.</p>
	</div>
</div>
<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash"># CUDA 10.2 
conda install pytorch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0 cudatoolkit=10.2 -c pytorch 
# CUDA 11.1 
conda install pytorch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0 cudatoolkit=11.1 -c pytorch -c conda-forge 
# CPU Only 
conda install pytorch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0 cpuonly -c pytorch
</code></pre>
</div>
<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash"># conda
conda install pytorch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0 -c pytorch</code></pre>
</div>


<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit.</p>
	</div>
</div>
<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-6f8a96c1-496c-4e08-9d31-4006efc9f4c0">
		
	Install LibTorch via Cocoapods</h3>
	</div>
<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pip install torch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0</code></pre>
</div>


<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.<br>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat sunt in culpa qui officia</p>
	</div>
</div>
<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash"># RocM 4.0.1 (Linux only)
pip install torch -f https://download.pytorch.org/whl/rocm4.0.1/torch_stable.html
pip install ninja
pip install 'git+https://github.com/pytorch/vision.git@v0.9.0'
# CUDA 11.0
pip install torch==1.8.0+cu111 torchvision==0.9.0+cu111 torchaudio==0.8.0 -f  

# CUDA 10.2
pip install torch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0

# CPU only
pip install torch==1.8.0+cpu torchvision==0.9.0+cpu torchaudio==0.8.0 -f https://download.pytorch.org/whl/torch_stable.html</code></pre>
</div>


<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Now it’s time to open the HelloWorld.xcworkspace in XCode, select an iOS simulator and launch it (cmd + R). If everything works well, we should see a wolf picture on the simulator screen along with the prediction result.</p>
	</div>
</div>
<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-54ff526a-f47d-42f5-9723-3868705a33e6">
		
	Code Walkthrough</h2>
	</div>


<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequate irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat sunt in culpa qui officia</p>
	</div>
</div>
<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pip install torch==1.8.0 torchvision==0.9.0 torchaudio==0.8.0</code></pre>
</div>
<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-6f3949b6-6a44-4b5c-a444-a95707d8a5bd">
		
	Image Loading</h3>
	</div>


<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Let’s begin with image loading.</p>
	</div>
</div>
<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">let image = UIImage(named: "image.jpg")!
imageView.image = image
let resizedImage = image.resized(to: CGSize(width: 224, height: 224))
guard var pixelBuffer = resizedImage.normalized() else {
    return</code></pre>
</div>


<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat sunt in culpa qui officia</p>
	</div>
</div>
<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-24c02f0f-c0df-46df-be59-618dbd22ea04">
		
	PYTORCH DEMO APP</h3>
	</div>


<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">For more complex use cases, we recommend to check out the <a href="#">PyTorch demo application</a>. The demo app contains two showcases. A camera app that runs a quantized model to predict the images coming from device’s rear-facing camera in real time. And a text-based app that uses a text classification model to predict the topic from the input string.</p>
	</div>
</div>
<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-8ce743b1-beff-441d-9889-32ce8104ce01">
		
	MORE PYTORCH IOS DEMO APPS</h3>
	</div>


<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="#">Image Segmentation</a> demonstrates a Python script that converts the PyTorch <a href="#">DeepLabV3</a> model for mobile apps to use and an iOS app that uses the model to segment images.<br><br>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.<br>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat sunt in culpa qui officia</p>
	</div>
</div>
</div>




<div class="Tabs">
	
<div class="Navigation is-style-tertiary">
	<ul id="menu-install-on-mobile-1" class="menu">
<li id="nav-menu-item-3028" class="menu-item menu-item-type-post_type menu-item-object-page"><button>iOS</button></li>
<li id="nav-menu-item-3027" class="menu-item menu-item-type-post_type menu-item-object-page"><button>ANDROID</button></li>
</ul>
</div>
	<ul class="tab-content-container">
					<li class="tab-content active">
									<div class="two-column-container">
						<div class="content">
							<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3d151b2b-7355-4570-ab5a-99ac27601583">
		
	iOS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To get started with PyTorch on iOS, we recommend exploring the following <a href="https://github.com/pytorch/ios-demo-app/tree/master/HelloWorld">HelloWorld</a>.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-16aa6cb6-39a8-498c-8cf4-e2bdf810ff95">
		
	QUICKSTART WITH A HELLO WORLD EXAMPLE</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">HelloWorld is a simple image classification application that demonstrates how to use PyTorch C++ libraries on iOS. The code is written in Swift and uses Objective-C as a bridge.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-73027d8e-0449-43f2-9ab5-4bd78577dd6a">
		
	Model Preparation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Let’s start with model preparation. If you are familiar with PyTorch, you probably should already know how to train and save your model. In case you don’t, we are going to use a pre-trained image classification model &#8211; <a href="https://pytorch.org/hub/pytorch_vision_mobilenet_v2/">MobileNet v2</a>, which is already packaged in <a href="https://pytorch.org/docs/stable/torchvision/index.html">TorchVision</a>. To install it, run the command below.</p>
	</div>
</div>



<div class="TextBlock is-style-code-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><em>We highly recommend following the </em><a href="https://github.com/pytorch/pytorch">Pytorch Github page</a><em> to set up the Python development environment on your local machine.</em></p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pip install torchvision</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Once we have TorchVision installed successfully, let’s navigate to the HelloWorld folder and run <code>trace_model.py</code>. The script contains the code of tracing and saving a <a href="https://pytorch.org/tutorials/beginner/Intro_to_TorchScript_tutorial.html">torchscript model</a> that can be run on mobile devices.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">python trace_model.py</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">If everything works well, we should have our model &#8211; <code>model.pt</code> generated in the <code>HelloWorld</code> folder. Now copy the model file to our application folder <code>HelloWorld/model</code>.</p>
	</div>
</div>



<div class="TextBlock is-style-code-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><em>To find out more details about TorchScript, please visit </em><a href="https://pytorch.org/tutorials/advanced/cpp_export.html">tutorials on pytorch.org</a></p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-0798c42c-5031-4382-bfcb-a0c27e3bcfd5">
		
	Install LibTorch-Lite via Cocoapods</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The PyTorch C++ library is available in <a href="https://cocoapods.org/">Cocoapods</a>, to integrate it to our project, simply run</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pod install</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Now it’s time to open the <code>HelloWorld.xcworkspace</code> in XCode, select an iOS simulator and launch it (cmd + R). If everything works well, we should see a wolf picture on the simulator screen along with the prediction result.</p>
	</div>
</div>


<div class="BlogImage BlogImage">

	<div class="container">
		<div class="imageCon">
			
<img class="Image image" src="/wp-content/uploads/2021/11/wolf.png" alt="">
		</div>
	</div>
</div>


<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-918a3d1d-3327-4ce0-8264-8c77c9990219">
		
	Code Walkthrough</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">In this part, we are going to walk through the code step by step.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-5f9b5885-e413-4e46-b911-8cc0bc3f4a6b">
		
	Image Loading</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Let’s begin with image loading.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">let image = UIImage(named: "image.jpg")!
imageView.image = image
let resizedImage = image.resized(to: CGSize(width: 224, height: 224))
guard var pixelBuffer = resizedImage.normalized() else {
    return
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">We first load the image from our bundle and resize it to 224&#215;224. Then we call this <code>normalized()</code> category method to normalized the pixel buffer. Let’s take a closer look at the code below.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">var normalizedBuffer: [Float32] = [Float32](repeating: 0, count: w * h * 3)
// normalize the pixel buffer
// see https://pytorch.org/hub/pytorch_vision_resnet/ for more detail
for i in 0 ..&lt; w * h {
    normalizedBuffer[i]             = (Float32(rawBytes[i * 4 + 0]) / 255.0 - 0.485) / 0.229 // R
    normalizedBuffer[w * h + i]     = (Float32(rawBytes[i * 4 + 1]) / 255.0 - 0.456) / 0.224 // G
    normalizedBuffer[w * h * 2 + i] = (Float32(rawBytes[i * 4 + 2]) / 255.0 - 0.406) / 0.225 // B
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The code might look weird at first glance, but it’ll make sense once we understand our model. The input data is a 3-channel RGB image of shape (3 x H x W), where H and W are expected to be at least 224. The image has to be loaded in to a range of <code>[0, 1]</code> and then normalized using <code>mean = [0.485, 0.456, 0.406]</code> and <code>std = [0.229, 0.224, 0.225]</code>.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-959d41a1-c5fa-4cd6-9780-524c8bba1096">
		
	TorchScript Module</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Now that we have preprocessed our input data and we have a pre-trained TorchScript model, the next step is to use them to run predication. To do that, we’ll first load our model into the application.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">private lazy var module: TorchModule = {
    if let filePath = Bundle.main.path(forResource: "model", ofType: "pt"),
        let module = TorchModule(fileAtPath: filePath) {
        return module
    } else {
        fatalError("Can't find the model file!")
    }
}()</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Note that the <code>TorchModule</code> Class is an Objective-C wrapper of <code>torch::jit::mobile::Module</code>.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">torch::jit::mobile::Module module = torch::jit::_load_for_mobile(filePath.UTF8String);</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Since Swift can not talk to C++ directly, we have to either use an Objective-C class as a bridge, or create a C wrapper for the C++ library. For demo purpose, we’re going to wrap everything in this Objective-C class.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-c96161ee-4ca4-44a4-bf81-4282332d981d">
		
	Run Inference</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Now it’s time to run inference and get the results.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">guard let outputs = module.predict(image: UnsafeMutableRawPointer(&amp;pixelBuffer)) else {
    return
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Again, the <code>predict</code> method is just an Objective-C wrapper. Under the hood, it calls the C++ <code>forward</code> function. Let’s take a look at how it’s implemented.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="cpp" class="language-cpp">at::Tensor tensor = torch::from_blob(imageBuffer, {1, 3, 224, 224}, at::kFloat);
c10::InferenceMode guard;
auto outputTensor = _impl.forward({tensor}).toTensor();
float* floatBuffer = outputTensor.data_ptr&lt;float&gt;();</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The C++ function <code>torch::from_blob</code> will create an input tensor from the pixel buffer. Note that the shape of the tensor is <code>{1,3,224,224}</code> which represents <code>{N, C, H, W}</code> as we discussed in the above section.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="cpp" class="language-cpp">c10::InferenceMode guard;</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The above line tells PyTorch to do inference only.<br><br>Finally, we can call this <code>forward</code> function to get the output tensor and convert it to a <code>float</code> buffer.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">auto outputTensor = _impl.forward({tensor}).toTensor();
float* floatBuffer = outputTensor.data_ptr&lt;float&gt;();</code></pre>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-66cbf17c-2e28-4679-938d-61899ea1d9b7">
		
	Collect Results</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The output tensor is a one-dimensional float array of shape 1&#215;1000, where each value represents the confidence that a label is predicted from the image. The code below sorts the array and retrieves the top three results.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">let zippedResults = zip(labels.indices, outputs)
let sortedResults = zippedResults.sorted { $0.1.floatValue &gt; $1.1.floatValue }.prefix(3)</code></pre>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-e42b810a-dec4-419e-8e1e-b935eb7e4da1">
		
	PYTORCH DEMO APP</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">For more complex use cases, we recommend to check out the <a href="https://github.com/pytorch/ios-demo-app">PyTorch demo application</a>. The demo app contains two showcases. A camera app that runs a quantized model to predict the images coming from device’s rear-facing camera in real time. And a text-based app that uses a text classification model to predict the topic from the input string.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-83a3168e-f9bd-4531-9a92-a3b65da52e1f">
		
	MORE PYTORCH IOS DEMO APPS</h2>
	</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-0feec513-7e2e-4aeb-a433-282255523372">
		
	Image Segmentation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/ImageSegmentation">Image Segmentation</a> demonstrates a Python script that converts the PyTorch <a href="https://pytorch.org/hub/pytorch_vision_deeplabv3_resnet101/">DeepLabV3</a> model for mobile apps to use and an iOS app that uses the model to segment images.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-dc96ea3a-83b3-4625-ab91-f3c819fb359c">
		
	Object Detection</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/ObjectDetection">Object Detection</a> demonstrates how to convert the popular <a href="https://pytorch.org/hub/ultralytics_yolov5/">YOLOv5</a> model and use it on an iOS app that detects objects from pictures in your photos, taken with camera, or with live camera.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-9a865830-2bfd-4e6d-bd9a-c70ec2f77b5e">
		
	Neural Machine Translation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/Seq2SeqNMT">Neural Machine Translation</a> demonstrates how to convert a sequence-to-sequence neural machine translation model trained with the code in the <a href="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html">PyTorch NMT tutorial</a> and use the model in an iOS app to do French-English translation.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-1c683489-9ca4-4b45-a76d-e4643eb6244b">
		
	Question Answering</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/QuestionAnswering">Question Answering</a> demonstrates how to convert a powerful transformer QA model and use the model in an iOS app to answer questions about PyTorch Mobile and more.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading HeadingBlock " id="block-9bd0d87a-4a7a-43d3-ad55-b2ea6c1658a6">
		
	Vision Transformer</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/ViT4MNIST">Vision Transformer</a> demonstrates how to use Facebook’s latest Vision Transformer <a href="https://github.com/facebookresearch/deit">DeiT</a> model to do image classification, and how convert another Vision Transformer model and use it in an iOS app to perform handwritten digit recognition.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-56eed797-80e4-41ed-94cd-2be1963090d0">
		
	Speech recognition</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/SpeechRecognition">Speech Recognition</a> demonstrates how to convert Facebook AI’s wav2vec 2.0, one of the leading models in speech recognition, to TorchScript and how to use the scripted model in an iOS app to perform speech recognition.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-b0ecf12a-6fc9-4ea0-8b39-04fafd00a38f">
		
	Video Classification</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/ios-demo-app/tree/master/TorchVideo">TorchVideo</a> demonstrates how to use a pre-trained video classification model, available at the newly released <a href="https://github.com/facebookresearch/pytorchvideo">PyTorchVideo</a>, on iOS to see video classification results, updated per second while the video plays, on tested videos, videos from the Photos library, or even real-time videos.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-1de0d93e-bd1f-4045-8ff1-ac7a6a669cbd">
		
	PYTORCH IOS TUTORIAL AND RECIPES</h2>
	</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-c13174f8-f7f4-4ea4-bae8-57257d48df85">
		
	<a href="https://pytorch.org/tutorials/beginner/deeplabv3_on_ios.html">Image Segmentation DeepLabV3 on iOS</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">A comprehensive step-by-step tutorial on how to prepare and run the PyTorch DeepLabV3 image segmentation model on iOS.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-5ed547b5-7471-4664-aed7-e6a5529b920a">
		
	<a href="https://pytorch.org/tutorials/recipes/mobile_perf.html">PyTorch Mobile Performance Recipes</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">List of recipes for performance optimizations for using PyTorch on Mobile.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-7c16cd86-9785-4c12-80c2-91f9744de820">
		
	<a href="https://pytorch.org/tutorials/recipes/fuse.html">Fuse Modules recipe</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to fuse a list of PyTorch modules into a single module to reduce the model size before quantization.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-f9509266-5807-4e2e-934d-51cf3755b87d">
		
	<a href="https://pytorch.org/tutorials/recipes/quantization.html">Quantization for Mobile Recipe</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to reduce the model size and make it run faster without losing much on accuracy.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-7528cf4a-fcbd-4daf-8a93-158576f41514">
		
	<a href="https://pytorch.org/tutorials/recipes/script_optimized.html">Script and Optimize for Mobile</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to convert the model to TorchScipt and (optional) optimize it for mobile apps.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-ccfe47c2-a024-4ed3-8b82-81af932057da">
		
	<a href="https://pytorch.org/tutorials/recipes/model_preparation_ios.html">Model Preparation for iOS Recipe</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to add the model in an iOS project and use PyTorch pod for iOS.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-94535888-7a56-421e-89ae-0eccbc00b05c">
		
	BUILD PYTORCH IOS LIBRARIES FROM SOURCE</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To track the latest updates for iOS, you can build the PyTorch iOS libraries from the source code.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">git clone --recursive https://github.com/pytorch/pytorch
cd pytorch
# if you are updating an existing checkout
git submodule sync
git submodule update --init --recursive</code></pre>
</div>



<div class="TextBlock is-style-code-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><em>Make sure you have </em><code>cmake</code><em> and Python installed correctly on your local machine. We recommend following the </em><a href="https://github.com/pytorch/pytorch">Pytorch Github page</a><em> to set up the Python development environment</em></p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-32b72a3f-963f-4e92-bcf7-b00021803e4d">
		
	Build LibTorch-Lite for iOS Simulators</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Open terminal and navigate to the PyTorch root directory. Run the following command (if you already build LibTorch-Lite for iOS devices (see below), run <code>rm -rf build_ios</code> first):</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">BUILD_PYTORCH_MOBILE=1 IOS_PLATFORM=SIMULATOR ./scripts/build_ios.sh</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">After the build succeeds, all static libraries and header files will be generated under <code>build_ios/install</code></p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-e8ded4b2-263e-42ac-9926-4d1abe2baa39">
		
	Build LibTorch-Lite for arm64 Devices</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Open terminal and navigate to the PyTorch root directory. Run the following command (if you already build LibTorch-Lite for iOS simulators, run <code>rm -rf build_ios</code> first):</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">BUILD_PYTORCH_MOBILE=1 IOS_ARCH=arm64 ./scripts/build_ios.sh</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">After the build succeeds, all static libraries and header files will be generated under <code>build_ios/install</code></p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-ff7fabb0-9f68-4888-9ee4-5b62e0a02ea7">
		
	XCode Setup</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Open your project in XCode, go to your project Target’s <code>Build Phases</code> &#8211; <code>Link Binaries With Libraries</code>, click the + sign and add all the library files located in <code>build_ios/install/lib</code>. Navigate to the project <code>Build Settings</code>, set the value <strong>Header Search Paths</strong> to <code>build_ios/install/include</code> and <strong>Library Search Paths</strong> to <code>build_ios/install/lib</code>.<br><br>In the build settings, search for <strong>other linker flags</strong>. Add a custom linker flag below</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">-all_load</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To use the custom built libraries the project, replace <code>#import &lt;LibTorch-Lite/LibTorch-Lite.h&gt;</code> (in <code>TorchModule.mm</code>) which is needed when using LibTorch-Lite via Cocoapods with the code below:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">#include &lt;torch/csrc/jit/mobile/import.h&gt;
#include &lt;torch/csrc/jit/mobile/module.h&gt;
#include &lt;torch/script.h&gt;</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Finally, disable bitcode for your target by selecting the Build Settings, searching for <strong>Enable Bitcode</strong>, and set the value to <strong>No</strong>.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-85b44f21-0a02-44e3-88d5-5962a1f7c3b5">
		
	USING THE NIGHTLY PYTORCH IOS LIBRARIES IN COCOAPODS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">If you want to try out the latest features added to PyTorch iOS, you can use the <code>LibTorch-Lite-Nightly</code> pod in your <code>Podfile</code>, it includes the nightly built libraries:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pod 'LibTorch-Lite-Nightly'</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">And then run <code>pod install</code> to add it to your project. If you wish to update the nightly pod to the newer one, you can run <code>pod update</code> to get the latest version. But be aware you may need to build the model used on mobile in the latest PyTorch &#8211; using either the latest PyTorch code or a quick nightly install with commands like <code>pip install --pre torch torchvision -f https://download.pytorch.org/whl/nightly/cpu/torch_nightly.html</code> &#8211; to avoid possible model version mismatch errors when running the model on mobile.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-1d50e90b-6b1e-4fe2-aea0-ed257fd5a34a">
		
	CUSTOM BUILD</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Starting from 1.4.0, PyTorch supports custom build. You can now build the PyTorch library that only contains the operators needed by your model. To do that, follow the steps below</p>
	</div>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">Verify your PyTorch version is 1.4.0 or above. You can do that by checking the value of <code>torch.__version__</code>.								</li>
												<li class="item">To dump the operators in your model, say <code>MobileNetV2</code>, run the following lines of Python code: 								</li>
					</ul>
	</div>
</div>


<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">import torch, yaml
model = torch.jit.load('MobileNetV2.pt')
ops = torch.jit.export_opnames(model)
with open('MobileNetV2.yaml', 'w') as output:
    yaml.dump(ops, output)</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">In the snippet above, you first need to load the ScriptModule. Then, use <code>export_opnames</code> to return a list of operator names of the ScriptModule and its submodules. Lastly, save the result in a yaml file.</p>
	</div>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">To run the iOS build script locally with the prepared yaml list of operators, pass in the yaml file generate from the last step into the environment variable <code>SELECTED_OP_LIST</code>. Also in the arguments, specify <code>BUILD_PYTORCH_MOBILE=1</code> as well as the platform/architechture type. Take the arm64 build for example, the command should be:								</li>
					</ul>
	</div>
</div>


<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">SELECTED_OP_LIST=MobileNetV2.yaml BUILD_PYTORCH_MOBILE=1 IOS_ARCH=arm64 ./scripts/build_ios.sh</code></pre>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">After the build succeeds, you can integrate the result libraries to your project by following the <a href="https://pytorch.org/mobile/ios/#xcode-setup">XCode Setup</a> section above.								</li>
												<li class="item">The last step is to add a single line of C++ code before running <code>forward</code>. This is because by default JIT will do some optimizations on operators (fusion for example), which might break the consistency with the ops we dumped from the model.								</li>
					</ul>
	</div>
</div>


<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">torch::jit::GraphOptimizerEnabledGuard guard(false);</code></pre>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-c084d935-0eff-46f2-a649-466ed954d312">
		
	USE PYTORCH JIT INTERPRETER</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">PyTorch JIT interpreter is the default interpreter before 1.9 (a version of our PyTorch interpreter that is not as size-efficient). It will still be supported in 1.9, and can be used in CocoaPods:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pod 'LibTorch', '~&gt;1.9.0'</code></pre>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-f2287bf8-13c9-4fc7-987e-083b3d155048">
		
	IOS TUTORIALS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Watch the following <a href="https://youtu.be/amTepUIR93k">video</a> as PyTorch Partner Engineer Brad Heintz walks through steps for setting up the PyTorch Runtime for iOS projects:</p>
	</div>
</div>


<div class="YoutubeVideo YoutubeVideo">
	<div class="container">
		<div class="video-wrapper">
			<iframe src="https://www.youtube.com/embed/amTepUIR93k?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
			</iframe>
		</div>
	</div>
</div>




<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The corresponding code can be found <a href="https://github.com/pytorch/workshops/tree/master/PTMobileWalkthruIOS">here</a>.<br><br>Additionally, checkout our <a href="https://pytorch.org/tutorials/recipes/mobile_perf.html">Mobile Performance Recipes</a> which cover how to optimize your model and check if optimizations helped via benchmarking.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3cd7ebb7-5d19-49d1-a381-f82accab0e37">
		
	API DOCS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Currently, the iOS framework uses the Pytorch C++ front-end APIs directly. The C++ document can be found <a href="https://pytorch.org/cppdocs/">here</a>. To learn more about it, we recommend exploring the <a href="https://pytorch.org/tutorials/advanced/cpp_frontend.html">C++ front-end tutorials</a> on PyTorch webpage.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-5e6ecdda-5d23-4f46-a58d-7c4ff3ad58e0">
		
	ISSUES AND CONTRIBUTION</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">If you have any questions or want to contribute to PyTorch, please feel free to drop issues or open a pull request to get in touch.</p>
	</div>
</div>						</div>
					
<div class="jump-list-container">
	<div class="jump-list-mobile-heading-container">
		<h2 class="jump-list-mobile-heading">TABLE OF CONTENTS</h2>
	</div>
	<ul class="jump-list">
				<li>
			<ul class="jump-list-links">
									<li class="jump-list-single">
					
											<a href="#block-3d151b2b-7355-4570-ab5a-99ac27601583" class="jump-link level-1" data-blockid="#block-3d151b2b-7355-4570-ab5a-99ac27601583">
						iOS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-16aa6cb6-39a8-498c-8cf4-e2bdf810ff95" class="jump-link level-1" data-blockid="#block-16aa6cb6-39a8-498c-8cf4-e2bdf810ff95">
						QUICKSTART WITH A HELLO WORLD EXAMPLE						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-73027d8e-0449-43f2-9ab5-4bd78577dd6a" class="jump-link level-1" data-blockid="#block-73027d8e-0449-43f2-9ab5-4bd78577dd6a">
						Model Preparation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-0798c42c-5031-4382-bfcb-a0c27e3bcfd5" class="jump-link level-1" data-blockid="#block-0798c42c-5031-4382-bfcb-a0c27e3bcfd5">
						Install LibTorch-Lite via Cocoapods						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-918a3d1d-3327-4ce0-8264-8c77c9990219" class="jump-link level-1" data-blockid="#block-918a3d1d-3327-4ce0-8264-8c77c9990219">
						Code Walkthrough						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-5f9b5885-e413-4e46-b911-8cc0bc3f4a6b" class="jump-link level-1" data-blockid="#block-5f9b5885-e413-4e46-b911-8cc0bc3f4a6b">
						Image Loading						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-959d41a1-c5fa-4cd6-9780-524c8bba1096" class="jump-link level-1" data-blockid="#block-959d41a1-c5fa-4cd6-9780-524c8bba1096">
						TorchScript Module						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-c96161ee-4ca4-44a4-bf81-4282332d981d" class="jump-link level-1" data-blockid="#block-c96161ee-4ca4-44a4-bf81-4282332d981d">
						Run Inference						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-66cbf17c-2e28-4679-938d-61899ea1d9b7" class="jump-link level-1" data-blockid="#block-66cbf17c-2e28-4679-938d-61899ea1d9b7">
						Collect Results						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-e42b810a-dec4-419e-8e1e-b935eb7e4da1" class="jump-link level-1" data-blockid="#block-e42b810a-dec4-419e-8e1e-b935eb7e4da1">
						PYTORCH DEMO APP						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-83a3168e-f9bd-4531-9a92-a3b65da52e1f" class="jump-link level-1" data-blockid="#block-83a3168e-f9bd-4531-9a92-a3b65da52e1f">
						MORE PYTORCH IOS DEMO APPS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-0feec513-7e2e-4aeb-a433-282255523372" class="jump-link level-1" data-blockid="#block-0feec513-7e2e-4aeb-a433-282255523372">
						Image Segmentation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-dc96ea3a-83b3-4625-ab91-f3c819fb359c" class="jump-link level-1" data-blockid="#block-dc96ea3a-83b3-4625-ab91-f3c819fb359c">
						Object Detection						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-9a865830-2bfd-4e6d-bd9a-c70ec2f77b5e" class="jump-link level-1" data-blockid="#block-9a865830-2bfd-4e6d-bd9a-c70ec2f77b5e">
						Neural Machine Translation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-1c683489-9ca4-4b45-a76d-e4643eb6244b" class="jump-link level-1" data-blockid="#block-1c683489-9ca4-4b45-a76d-e4643eb6244b">
						Question Answering						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-9bd0d87a-4a7a-43d3-ad55-b2ea6c1658a6" class="jump-link level-1" data-blockid="#block-9bd0d87a-4a7a-43d3-ad55-b2ea6c1658a6">
						Vision Transformer						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-56eed797-80e4-41ed-94cd-2be1963090d0" class="jump-link level-1" data-blockid="#block-56eed797-80e4-41ed-94cd-2be1963090d0">
						Speech recognition						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-b0ecf12a-6fc9-4ea0-8b39-04fafd00a38f" class="jump-link level-1" data-blockid="#block-b0ecf12a-6fc9-4ea0-8b39-04fafd00a38f">
						Video Classification						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-1de0d93e-bd1f-4045-8ff1-ac7a6a669cbd" class="jump-link level-1" data-blockid="#block-1de0d93e-bd1f-4045-8ff1-ac7a6a669cbd">
						PYTORCH IOS TUTORIAL AND RECIPES						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-c13174f8-f7f4-4ea4-bae8-57257d48df85" class="jump-link level-1" data-blockid="#block-c13174f8-f7f4-4ea4-bae8-57257d48df85">
						Image Segmentation DeepLabV3 on iOS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-5ed547b5-7471-4664-aed7-e6a5529b920a" class="jump-link level-1" data-blockid="#block-5ed547b5-7471-4664-aed7-e6a5529b920a">
						PyTorch Mobile Performance Recipes						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-7c16cd86-9785-4c12-80c2-91f9744de820" class="jump-link level-1" data-blockid="#block-7c16cd86-9785-4c12-80c2-91f9744de820">
						Fuse Modules recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-f9509266-5807-4e2e-934d-51cf3755b87d" class="jump-link level-1" data-blockid="#block-f9509266-5807-4e2e-934d-51cf3755b87d">
						Quantization for Mobile Recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-7528cf4a-fcbd-4daf-8a93-158576f41514" class="jump-link level-1" data-blockid="#block-7528cf4a-fcbd-4daf-8a93-158576f41514">
						Script and Optimize for Mobile						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-ccfe47c2-a024-4ed3-8b82-81af932057da" class="jump-link level-1" data-blockid="#block-ccfe47c2-a024-4ed3-8b82-81af932057da">
						Model Preparation for iOS Recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-94535888-7a56-421e-89ae-0eccbc00b05c" class="jump-link level-1" data-blockid="#block-94535888-7a56-421e-89ae-0eccbc00b05c">
						BUILD PYTORCH IOS LIBRARIES FROM SOURCE						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-32b72a3f-963f-4e92-bcf7-b00021803e4d" class="jump-link level-1" data-blockid="#block-32b72a3f-963f-4e92-bcf7-b00021803e4d">
						Build LibTorch-Lite for iOS Simulators						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-e8ded4b2-263e-42ac-9926-4d1abe2baa39" class="jump-link level-1" data-blockid="#block-e8ded4b2-263e-42ac-9926-4d1abe2baa39">
						Build LibTorch-Lite for arm64 Devices						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-ff7fabb0-9f68-4888-9ee4-5b62e0a02ea7" class="jump-link level-1" data-blockid="#block-ff7fabb0-9f68-4888-9ee4-5b62e0a02ea7">
						XCode Setup						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-85b44f21-0a02-44e3-88d5-5962a1f7c3b5" class="jump-link level-1" data-blockid="#block-85b44f21-0a02-44e3-88d5-5962a1f7c3b5">
						USING THE NIGHTLY PYTORCH IOS LIBRARIES IN COCOAPO&#8230;						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-1d50e90b-6b1e-4fe2-aea0-ed257fd5a34a" class="jump-link level-1" data-blockid="#block-1d50e90b-6b1e-4fe2-aea0-ed257fd5a34a">
						CUSTOM BUILD						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-c084d935-0eff-46f2-a649-466ed954d312" class="jump-link level-1" data-blockid="#block-c084d935-0eff-46f2-a649-466ed954d312">
						USE PYTORCH JIT INTERPRETER						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-f2287bf8-13c9-4fc7-987e-083b3d155048" class="jump-link level-1" data-blockid="#block-f2287bf8-13c9-4fc7-987e-083b3d155048">
						IOS TUTORIALS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3cd7ebb7-5d19-49d1-a381-f82accab0e37" class="jump-link level-1" data-blockid="#block-3cd7ebb7-5d19-49d1-a381-f82accab0e37">
						API DOCS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-5e6ecdda-5d23-4f46-a58d-7c4ff3ad58e0" class="jump-link level-1" data-blockid="#block-5e6ecdda-5d23-4f46-a58d-7c4ff3ad58e0">
						ISSUES AND CONTRIBUTION						</a>
															</li>
							</ul>
		</li>
	</ul>
</div>
				</div>
							</li>
								<li class="tab-content ">
									<div class="two-column-container">
						<div class="content">
							<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-dd10b963-2b34-4408-ba37-49b2d6d99ec3">
		
	Android</h2>
	</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3f34275f-d11d-4ce4-a6b8-9257b3f8e3c3">
		
	QUICKSTART WITH A HELLOWORLD EXAMPLE</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/HelloWorldApp">HelloWorld</a> is a simple image classification application that demonstrates how to use PyTorch Android API. This application runs TorchScript serialized TorchVision pretrained resnet18 model on static image which is packaged inside the app as android asset.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-708b0333-b952-4008-895b-533b6e5ba722">
		
	1. Model Preparation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Let’s start with model preparation. If you are familiar with PyTorch, you probably should already know how to train and save your model. In case you don’t, we are going to use a pre-trained image classification model (<a href="https://pytorch.org/hub/pytorch_vision_mobilenet_v2/">MobileNetV2</a>). To install it, run the command below:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">pip install torchvision</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To serialize the model you can use python <a href="https://github.com/pytorch/android-demo-app/blob/master/HelloWorldApp/trace_model.py">script</a> in the root folder of HelloWorld app:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">import torch
import torchvision
from torch.utils.mobile_optimizer import optimize_for_mobile

model = torchvision.models.mobilenet_v2(pretrained=True)
model.eval()
example = torch.rand(1, 3, 224, 224)
traced_script_module = torch.jit.trace(model, example)
traced_script_module_optimized = optimize_for_mobile(traced_script_module)
traced_script_module_optimized._save_for_lite_interpreter("app/src/main/assets/model.ptl")</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">If everything works well, we should have our model &#8211; <code>model.ptl</code> generated in the assets folder of android application. That will be packaged inside android application as <code>asset</code> and can be used on the device.<br><br>More details about TorchScript you can find in <a href="https://pytorch.org/docs/stable/jit.html">tutorials on pytorch.org</a></p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-8774d715-5587-44c8-9ca2-e0b0d887e226">
		
	2. Cloning from github</h3>
	</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">git clone https://github.com/pytorch/android-demo-app.git
cd HelloWorldApp</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">If <a href="https://developer.android.com/studio/index.html#command-tools">Android SDK</a> and <a href="https://developer.android.com/ndk/downloads">Android NDK</a> are already installed you can install this application to the connected android device or emulator with:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">./gradlew installDebug</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">We recommend you to open this project in <a href="https://developer.android.com/studio">Android Studio 3.5.1+</a>. At the moment PyTorch Android and demo applications use <a href="https://developer.android.com/studio/releases/gradle-plugin#3-5-0">android gradle plugin of version 3.5.0</a>, which is supported only by Android Studio version 3.5.1 and higher. Using Android Studio you will be able to install Android NDK and Android SDK with Android Studio UI.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-405699da-5447-4909-965e-ed3fcb40a6e4">
		
	3. Gradle dependencies</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Pytorch android is added to the HelloWorld as <a href="https://github.com/pytorch/android-demo-app/blob/master/HelloWorldApp/app/build.gradle#L28-L29">gradle dependencies</a> in build.gradle:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">repositories {
    jcenter()
}

dependencies {
    implementation 'org.pytorch:pytorch_android_lite:1.9.0'
    implementation 'org.pytorch:pytorch_android_torchvision:1.9.0'
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Where <code>org.pytorch:pytorch_android</code> is the main dependency with PyTorch Android API, including libtorch native library for all 4 android abis (armeabi-v7a, arm64-v8a, x86, x86_64). Further in this doc you can find how to rebuild it only for specific list of android abis.<br><br><code>org.pytorch:pytorch_android_torchvision</code> &#8211; additional library with utility functions for converting <code>android.media.Image</code> and <code>android.graphics.Bitmap</code> to tensors.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-0d304981-7a55-4f7d-9166-c0d613b13775">
		
	4. Reading image from Android Asset</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">All the logic happens in <a href="https://github.com/pytorch/android-demo-app/blob/master/HelloWorldApp/app/src/main/java/org/pytorch/helloworld/MainActivity.java#L31-L69"><code>org.pytorch.helloworld.MainActivity</code></a>. As a first step we read <code>image.jpg</code> to <code>android.graphics.Bitmap</code> using the standard Android API.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">Bitmap bitmap = BitmapFactory.decodeStream(getAssets().open("image.jpg"));</code></pre>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-03e7301c-e4da-4657-87d1-74ce72b56ff5">
		
	5. Loading Mobile Module</h3>
	</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">Module module = Module.load(assetFilePath(this, "model.ptl"));</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><code>org.pytorch.Module</code> represents <code>torch::jit::mobile::Module</code> that can be loaded with <code>load</code> method specifying file path to the serialized to file model.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-8e367e82-eda0-4ccf-b792-5e0c4b2989cc">
		
	6. Preparing Input</h3>
	</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">Tensor inputTensor = TensorImageUtils.bitmapToFloat32Tensor(bitmap,
    TensorImageUtils.TORCHVISION_NORM_MEAN_RGB, TensorImageUtils.TORCHVISION_NORM_STD_RGB);</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><code>org.pytorch.torchvision.TensorImageUtils</code> is part of <code>org.pytorch:pytorch_android_torchvision</code> library. The <code>TensorImageUtils#bitmapToFloat32Tensor</code> method creates tensors in the <a href="https://pytorch.org/docs/stable/torchvision/models.html">torchvision format</a> using <code>android.graphics.Bitmap</code> as a source.</p>
	</div>
</div>



<div class="TextBlock is-style-code-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><em>All pre-trained models expect input images normalized in the same way, i.e. mini-batches of 3-channel RGB images of shape (3 x H x W), where H and W are expected to be at least 224. The images have to be loaded in to a range of </em><code>[0, 1]</code><em> and then normalized using </em><code>mean = [0.485, 0.456, 0.406]</code><em> and </em><code>std = [0.229, 0.224, 0.225]</code></p>
	</div>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><code>inputTensor</code>’s shape is <code>1x3xHxW</code>, where <code>H</code> and <code>W</code> are bitmap height and width appropriately.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-e618d1ec-e8eb-43c1-bdb0-54759133f6fc">
		
	7. Run Inference</h3>
	</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">Tensor outputTensor = module.forward(IValue.from(inputTensor)).toTensor();
float[] scores = outputTensor.getDataAsFloatArray();</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><code>org.pytorch.Module.forward</code> method runs loaded module’s <code>forward</code> method and gets result as <code>org.pytorch.Tensor</code> outputTensor with shape <code>1x1000</code>.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-17dc762b-ecbb-454d-99b9-d3ec282043bb">
		
	8. Processing results</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Its content is retrieved using <code>org.pytorch.Tensor.getDataAsFloatArray()</code> method that returns java array of floats with scores for every image net class.<br><br>After that we just find index with maximum score and retrieve predicted class name from <code>ImageNetClasses.IMAGENET_CLASSES</code> array that contains all ImageNet classes.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">float maxScore = -Float.MAX_VALUE;
int maxScoreIdx = -1;
for (int i = 0; i &lt; scores.length; i++) {
  if (scores[i] &gt; maxScore) {
    maxScore = scores[i];
    maxScoreIdx = i;
  }
}
String className = ImageNetClasses.IMAGENET_CLASSES[maxScoreIdx];</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">In the following sections you can find detailed explanations of PyTorch Android API, code walk through for a bigger <a href="https://github.com/pytorch/android-demo-app/tree/master/PyTorchDemoApp">demo application</a>, implementation details of the API, how to customize and build it from source.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3d843c4f-f59c-45df-b640-cbb0e08dbfbd">
		
	PYTORCH DEMO APPLICATION</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">We have also created another more complex PyTorch Android demo application that does image classification from camera output and text classification in the <a href="https://github.com/pytorch/android-demo-app/tree/master/PyTorchDemoApp">same github repo</a>.<br><br>To get device camera output it uses <a href="https://developer.android.com/training/camerax">Android CameraX API</a>. All the logic that works with CameraX is separated to <a href="https://github.com/pytorch/android-demo-app/blob/master/PyTorchDemoApp/app/src/main/java/org/pytorch/demo/vision/AbstractCameraXActivity.java"><code>org.pytorch.demo.visionWe have also created another more complex PyTorch Android demo application that does image classification from camera output and text classification in the <a href="https://github.com/pytorch/android-demo-app/tree/master/PyTorchDemoApp">same github repo</a>.</code></a><br><a href="https://github.com/pytorch/android-demo-app/blob/master/PyTorchDemoApp/app/src/main/java/org/pytorch/demo/vision/AbstractCameraXActivity.java"><code><br>To get device camera output it uses <a href="https://developer.android.com/training/camerax">Android CameraX API</a>. All the logic that works with CameraX is separated to <a href="https://github.com/pytorch/android-demo-app/blob/master/PyTorchDemoApp/app/src/main/java/org/pytorch/demo/vision/AbstractCameraXActivity.java"><code>org.pytorch.demo.vision.AbstractCameTo get device camera output it uses <a href="https://developer.android.com/training/camerax">Android CameraX API</a>. All the logic that works with CameraX is separated to <a href="https://github.com/pytorch/android-demo-app/blob/master/PyTorchDemoApp/app/src/main/java/org/pytorch/demo/vision/AbstractCameraXActivity.java"><code>org.pytorch.demo.vision.AbstractCameraXActivity</code></a> class.</code></a></code></a></p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">void setupCameraX() {
    final PreviewConfig previewConfig = new PreviewConfig.Builder().build();
    final Preview preview = new Preview(previewConfig);
    preview.setOnPreviewOutputUpdateListener(output -&gt; mTextureView.setSurfaceTexture(output.getSurfaceTexture()));

    final ImageAnalysisConfig imageAnalysisConfig =
        new ImageAnalysisConfig.Builder()
            .setTargetResolution(new Size(224, 224))
            .setCallbackHandler(mBackgroundHandler)
            .setImageReaderMode(ImageAnalysis.ImageReaderMode.ACQUIRE_LATEST_IMAGE)
            .build();
    final ImageAnalysis imageAnalysis = new ImageAnalysis(imageAnalysisConfig);
    imageAnalysis.setAnalyzer(
        (image, rotationDegrees) -&gt; {
          analyzeImage(image, rotationDegrees);
        });

    CameraX.bindToLifecycle(this, preview, imageAnalysis);
  }

  void analyzeImage(android.media.Image, int rotationDegrees)</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Where the <code>analyzeImage</code> method process the camera output, <code>android.media.Image</code>.<br><br>It uses the aforementioned <a href="https://github.com/pytorch/pytorch/blob/master/android/pytorch_android_torchvision/src/main/java/org/pytorch/torchvision/TensorImageUtils.java#L90"><code>TensorImageUtils.imageYUV420CenterCropToFloat32Tensor</code></a> method to convert <code>android.media.Image</code> in <code>YUV420</code> format to input tensor.<br><br>After getting predicted scores from the model it finds top K classes with the highest scores and shows on the UI.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-subheading HeadingBlock " id="block-da9fb6fe-4006-4f6d-af86-51c1e92982f4">
		
	Language Processing Example</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Another example is natural language processing, based on an LSTM model, trained on a reddit comments dataset. The logic happens in <a href="https://github.com/pytorch/android-demo-app/blob/master/PyTorchDemoApp/app/src/main/java/org/pytorch/demo/nlp/TextClassificationActivity.java"><code>TextClassificattionActivity</code></a>.<br><br>Result class names are packaged inside the TorchScript model and initialized just after initial module initialization. The module has a <code>get_classes</code> method that returns <code>List[str]</code>, which can be called using method <code>Module.runMethod(methodName)</code>:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">  mModule = Module.load(moduleFileAbsoluteFilePath);
    IValue getClassesOutput = mModule.runMethod("get_classes");</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The returned <code>IValue</code> can be converted to java array of <code>IValue</code> using <code>IValue.toList()</code> and processed to an array of strings using <code>IValue.toStr()</code>:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">    IValue[] classesListIValue = getClassesOutput.toList();
    String[] moduleClasses = new String[classesListIValue.length];
    int i = 0;
    for (IValue iv : classesListIValue) {
      moduleClasses[i++] = iv.toStr();
    }</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Entered text is converted to java array of bytes with <code>UTF-8</code> encoding. <code>Tensor.fromBlobUnsigned</code> creates tensor of <code>dtype=uint8</code> from that array of bytes.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">byte[] bytes = text.getBytes(Charset.forName("UTF-8"));
final long[] shape = new long[]{1, bytes.length};
final Tensor inputTensor = Tensor.fromBlobUnsigned(bytes, shape);</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Running inference of the model is similar to previous examples:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">Tensor outputTensor = mModule.forward(IValue.from(inputTensor)).toTensor()</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">After that, the code processes the output, finding classes with the highest scores.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-2ab9801a-ab08-4315-9b4d-0a765a9ae512">
		
	MORE PYTORCH ANDROID DEMO APPS</h3>
	</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-f6d48450-34d4-4f98-88da-c4cc2e174bf6">
		
	D2go</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/D2Go">D2Go</a> demonstrates a Python script that creates the much lighter and much faster Facebook <a href="https://github.com/facebookresearch/d2go">D2Go</a> model that is powered by PyTorch 1.8, torchvision 0.9, and Detectron2 with built-in SOTA networks for mobile, and an Android app that uses it to detect objects from pictures in your photos, taken with camera, or with live camera. This demo app also shows how to use the native pre-built torchvision-ops library.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-9557a72e-f61e-4708-93e6-f367be95c523">
		
	Image Segmentation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/ImageSegmentation">Image Segmentation</a> demonstrates a Python script that converts the PyTorch <a href="https://pytorch.org/hub/pytorch_vision_deeplabv3_resnet101/">DeepLabV3</a> model and an Android app that uses the model to segment images.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-a2ae4f06-a4b0-4174-8fa2-1a6af8fc560e">
		
	Object Detection</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/ObjectDetection">Object Detection</a> demonstrates how to convert the popular <a href="https://pytorch.org/hub/ultralytics_yolov5/">YOLOv5</a> model and use it in an Android app that detects objects from pictures in your photos, taken with camera, or with live camera.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-32b33535-87fa-4c50-b5d2-1f1acdaae257">
		
	Neural Machine Translation</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/Seq2SeqNMT">Neural Machine Translation</a> demonstrates how to convert a sequence-to-sequence neural machine translation model trained with the code in the <a href="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html">PyTorch NMT tutorial</a> and use the model in an Android app to do French-English translation.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-402abc6f-9c91-4f28-9845-e83ba5e1616b">
		
	Question Answering</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/QuestionAnswering">Question Answering</a> demonstrates how to convert a powerful transformer QA model and use the model in an Android app to answer questions about PyTorch Mobile and more.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-5234adb7-21ac-479a-9dad-068667d0189d">
		
	Vision Transformer</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/ViT4MNIST">Vision Transformer</a> demonstrates how to use Facebook’s latest Vision Transformer <a href="https://github.com/facebookresearch/deit">DeiT</a> model to do image classification, and how convert another Vision Transformer model and use it in an Android app to perform handwritten digit recognition.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-b36f68e6-4864-4f50-9b4f-6fc668155c0d">
		
	Speech recognition</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/SpeechRecognition">Speech Recognition</a> demonstrates how to convert Facebook AI’s wav2vec 2.0, one of the leading models in speech recognition, to TorchScript and how to use the scripted model in an Android app to perform speech recognition.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-53aaede6-25f5-40ab-a710-7815b422910b">
		
	Video Classification</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"><a href="https://github.com/pytorch/android-demo-app/tree/master/TorchVideo">TorchVideo</a> demonstrates how to use a pre-trained video classification model, available at the newly released <a href="https://github.com/facebookresearch/pytorchvideo">PyTorchVideo</a>, on Android to see video classification results, updated per second while the video plays, on tested videos, videos from the Photos library, or even real-time videos.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-508ff49b-9add-41b4-8cc5-dbb9c24bc64c">
		
	PYTORCH ANDROID TUTORIAL AND RECIPES</h2>
	</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-0e0bbd72-d3e6-400c-bb5f-f2a93245076e">
		
	<a href="https://pytorch.org/tutorials/beginner/deeplabv3_on_android.html">Image Segmentation DeepLabV3 on Android</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">A comprehensive step-by-step tutorial on how to prepare and run the PyTorch DeepLabV3 image segmentation model on Android.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-cac30e64-2655-4c9e-9d51-077b0b8827a6">
		
	<a href="https://pytorch.org/tutorials/recipes/mobile_perf.html">PyTorch Mobile Performance Recipes</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">List of recipes for performance optimizations for using PyTorch on Mobile.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-63edae1a-5eb5-45bf-aeb6-c459705ac226">
		
	<a href="https://pytorch.org/tutorials/recipes/android_native_app_with_custom_op.html">Making Android Native Application That Uses PyTorch Android Prebuilt Libraries</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to make Android application from the scratch that uses LibTorch C++ API and uses TorchScript model with custom C++ operator.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-a6b93a2b-feda-4b3f-a392-df90b0649bfa">
		
	<a href="https://pytorch.org/tutorials/recipes/fuse.html">Fuse Modules recipe</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to fuse a list of PyTorch modules into a single module to reduce the model size before quantization.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-5a6a2240-0c30-4581-92f2-d1cc61f29e3e">
		
	<a href="https://pytorch.org/tutorials/recipes/quantization.html">Quantization for Mobile Recipe</a><br>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to reduce the model size and make it run faster without losing much on accuracy.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-fc788b7b-7e12-4995-ab75-e3c54be45d02">
		
	<a href="https://pytorch.org/tutorials/recipes/script_optimized.html">Script and Optimize for Mobile</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to convert the model to TorchScipt and (optional) optimize it for mobile apps.</p>
	</div>
</div>

<div class="">
<h3 class="HeadingBlock Heading is-style-section-heading HeadingBlock " id="block-2e8c7edc-b872-49f2-abf9-67ae7b5101d3">
		
	<a href="https://pytorch.org/tutorials/recipes/model_preparation_android.html">Model Preparation for Android Recipe</a>
</h3>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Learn how to add the model in an Android project and use the PyTorch library for Android.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-c6846267-7870-4f5d-9a0e-1e5e2582497f">
		
	BUILDING PYTORCH ANDROID FROM SOURCE</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">In some cases you might want to use a local build of PyTorch android, for example you may build custom LibTorch binary with another set of operators or to make local changes, or try out the latest PyTorch code.<br><br>For this you can use <code>./scripts/build_pytorch_android.sh</code> script.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">git clone https://github.com/pytorch/pytorch.git
cd pytorch
sh ./scripts/build_pytorch_android.sh</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The workflow contains several steps:</p>
	</div>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text"></p>
	</div>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">Build libtorch for android for all 4 android abis (armeabi-v7a, arm64-v8a, x86, x86_64)								</li>
												<li class="item">Create symbolic links to the results of those builds:  <code>android/pytorch_android/src/main/jniLibs/${abi}</code> to the directory with output libraries <code>android/pytorch_android/src/main/cpp/libtorch_include/${abi}</code> to the directory with headers. These directories are used to build <code>libpytorch_jni.so</code> library, as part of the <code>pytorch_android-release.aar</code> bundle, that will be loaded on android device.								</li>
												<li class="item">And finally run <code>gradle</code> in <code>android/pytorch_android</code> directory with task <code>assembleRelease</code>								</li>
					</ul>
	</div>
</div>




<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Script requires that Android SDK, Android NDK, Java SDK, and gradle are installed. They are specified as environment variables:<br><br><code>ANDROID_HOME</code> &#8211; path to <a href="https://developer.android.com/studio/command-line/sdkmanager.html">Android SDK</a><br><code>ANDROID_NDK</code> &#8211; path to <a href="https://developer.android.com/studio/projects/install-ndk">Android NDK</a><br><code>GRADLE_HOME</code> &#8211; path to <a href="https://gradle.org/releases/">gradle</a><br><code>JAVA_HOME</code> &#8211; path to <a href="https://www.oracle.com/java/technologies/javase-downloads.html#javasejdk">JAVA JDK</a><br>After successful build, you should see the result as aar file:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">$ find android -type f -name *aar
android/pytorch_android/build/outputs/aar/pytorch_android-release.aar
android/pytorch_android_torchvision/build/outputs/aar/pytorch_android_torchvision-release.aar</code></pre>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3dce6560-3ab4-4bb8-b532-64492e1b2028">
		
	USING THE PYTORCH ANDROID LIBRARIES BUILT FROM SOURCE OR NIGHTLY</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">First add the two aar files built above, or downloaded from the nightly built PyTorch Android repos at <a href="https://oss.sonatype.org/#nexus-search;quick~pytorch_android">here</a> and <a href="https://oss.sonatype.org/#nexus-search;quick~torchvision_android">here</a>, to the Android project’s <code>lib</code> folder, then add in the project’s app <code>build.gradle</code> file:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">allprojects {
    repositories {
        flatDir {
            dirs 'libs'
        }
    }
}

dependencies {

    // if using the libraries built from source
    implementation(name:'pytorch_android-release', ext:'aar')
    implementation(name:'pytorch_android_torchvision-release', ext:'aar')

    // if using the nightly built libraries downloaded above, for example the 1.8.0-snapshot on Jan. 21, 2021
    // implementation(name:'pytorch_android-1.8.0-20210121.092759-172', ext:'aar')
    // implementation(name:'pytorch_android_torchvision-1.8.0-20210121.092817-173', ext:'aar')

    ...
    implementation 'com.android.support:appcompat-v7:28.0.0'
    implementation 'com.facebook.fbjni:fbjni-java-only:0.0.3'
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Also we have to add all transitive dependencies of our aars. As <code>pytorch_android</code> depends on <code>com.android.support:appcompat-v7:28.0.0</code> or <code>androidx.appcompat:appcompat:1.2.0</code>, we need to one of them. (In case of using maven dependencies they are added automatically from <code>pom.xml</code>).</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3584f1c7-fe59-4ce1-9d7b-9aa2de391f2c">
		
	USING THE NIGHTLY PYTORCH ANDROID LIBRARIES</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Other than using the aar files built from source or downloaded from the links in the previous section, you can also use the nightly built Android PyTorch and TorchVision libraries by adding in your app <code>build.gradle</code> file the maven url and the nightly libraries implementation as follows:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">repositories {
    maven {
        url "https://oss.sonatype.org/content/repositories/snapshots"
    }
}

dependencies {
    ...
    implementation 'org.pytorch:pytorch_android:1.8.0-SNAPSHOT'
    implementation 'org.pytorch:pytorch_android_torchvision:1.8.0-SNAPSHOT'
}</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">This is the easiest way to try out the latest PyTorch code and the Android libraries, if you do not need to make any local changes. But be aware you may need to build the model used on mobile in the latest PyTorch &#8211; using either the latest PyTorch code or a quick nightly install with commands like <code>pip install --pre torch torchvision -f https://download.pytorch.org/whl/nightly/cpu/torch_nightly.html</code> &#8211; to avoid possible model version mismatch errors when running the model on mobile.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-3282f9d8-8e8a-4432-9f0b-dd13c2c186df">
		
	CUSTOM BUILD</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To reduce the size of binaries you can do custom build of PyTorch Android with only set of operators required by your model. This includes two steps: preparing the list of operators from your model, rebuilding pytorch android with specified list.</p>
	</div>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">Verify your PyTorch version is 1.4.0 or above. You can do that by checking the value of <code>torch.__version__</code>.								</li>
												<li class="item">Preparation of the list of operators								</li>
					</ul>
	</div>
</div>




<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">List of operators of your serialized torchscript model can be prepared in yaml format using python api function <code>torch.jit.export_opnames()</code>. To dump the operators in your model, say <code>MobileNetV2</code>, run the following lines of Python code:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash"># Dump list of operators used by MobileNetV2:
import torch, yaml
model = torch.jit.load('MobileNetV2.pt')
ops = torch.jit.export_opnames(model)
with open('MobileNetV2.yaml', 'w') as output:
    yaml.dump(ops, output)</code></pre>
</div>


<div class="blog-list-container blog-list-container">
	<div class="container">
		<ul class="list  indent-con">
												<li class="item">Building PyTorch Android with prepared operators list.								</li>
					</ul>
	</div>
</div>




<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">To build PyTorch Android with the prepared yaml list of operators, specify it in the environment variable <code>SELECTED_OP_LIST</code>. Also in the arguments, specify which Android ABIs it should build; by default it builds all 4 Android ABIs.</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash"># Build PyTorch Android library customized for MobileNetV2:
SELECTED_OP_LIST=MobileNetV2.yaml scripts/build_pytorch_android.sh arm64-v8a</code></pre>
</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">After successful build you can integrate the result aar files to your android gradle project, following the steps from previous section of this tutorial (Building PyTorch Android from Source).</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-81f50b93-f6bf-4903-9406-5a6bee3f8c3a">
		
	USE PYTORCH JIT INTERPRETER</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">PyTorch JIT interpreter is the default interpreter before 1.9 (a version of our PyTorch interpreter that is not as size-efficient). It will still be supported in 1.9, and can be used via <code>build.gradle</code>:</p>
	</div>
</div>

<div class="code-block">
<pre class="wp-block-code"><code lang="bash" class="language-bash">repositories {
    jcenter()
}

dependencies {
    implementation 'org.pytorch:pytorch_android:1.9.0'
    implementation 'org.pytorch:pytorch_android_torchvision:1.9.0'
}</code></pre>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-7dffeb3c-e1b1-4988-b138-05dcd493e64c">
		
	ANDROID TUTORIALS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">Watch the following <a href="https://youtu.be/5Lxuu16_28o">video</a> as PyTorch Partner Engineer Brad Heintz walks through steps for setting up the PyTorch Runtime for Android projects:</p>
	</div>
</div>


<div class="YoutubeVideo YoutubeVideo">
	<div class="container">
		<div class="video-wrapper">
			<iframe src="https://www.youtube.com/embed/5Lxuu16_28o?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
			</iframe>
		</div>
	</div>
</div>




<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">The corresponding code can be found <a href="https://github.com/pytorch/workshops/tree/master/PTMobileWalkthruAndroid">here</a>.<br><br>Checkout our <a href="https://pytorch.org/tutorials/recipes/mobile_perf.html">Mobile Performance Recipes</a> which cover how to optimize your model and check if optimizations helped via benchmarking.<br><br>In addition, follow this recipe to learn how to <a href="https://pytorch.org/tutorials/recipes/android_native_app_with_custom_op.html">make Native Android Application that use PyTorch prebuilt libraries</a>.</p>
	</div>
</div>

<div class="">
<h2 class="HeadingBlock Heading is-style-secondary-heading HeadingBlock " id="block-85ac6da6-36af-4028-9f93-c6cb8fd4da1d">
		
	API DOCS</h2>
	</div>



<div class="TextBlock is-style-medium-text TextBlock padding-size-small padding-size-small">
	<div class="container">
				<p class="rich-text">You can find more details about the PyTorch Android API in the <a href="https://pytorch.org/javadoc/">Javadoc</a>.</p>
	</div>
</div>						</div>
					
<div class="jump-list-container">
	<div class="jump-list-mobile-heading-container">
		<h2 class="jump-list-mobile-heading">TABLE OF CONTENTS</h2>
	</div>
	<ul class="jump-list">
					<li class="jump-list-title">
			<h3 class="jump-list-heading">Shortcuts</h3>
			</li>
				<li>
			<ul class="jump-list-links">
									<li class="jump-list-single">
					
											<a href="#block-dd10b963-2b34-4408-ba37-49b2d6d99ec3" class="jump-link level-1" data-blockid="#block-dd10b963-2b34-4408-ba37-49b2d6d99ec3">
						Android						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3f34275f-d11d-4ce4-a6b8-9257b3f8e3c3" class="jump-link level-1" data-blockid="#block-3f34275f-d11d-4ce4-a6b8-9257b3f8e3c3">
						QUICKSTART WITH A HELLOWORLD EXAMPLE						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-708b0333-b952-4008-895b-533b6e5ba722" class="jump-link level-1" data-blockid="#block-708b0333-b952-4008-895b-533b6e5ba722">
						1. Model Preparation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-8774d715-5587-44c8-9ca2-e0b0d887e226" class="jump-link level-1" data-blockid="#block-8774d715-5587-44c8-9ca2-e0b0d887e226">
						2. Cloning from github						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-405699da-5447-4909-965e-ed3fcb40a6e4" class="jump-link level-1" data-blockid="#block-405699da-5447-4909-965e-ed3fcb40a6e4">
						3. Gradle dependencies						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-0d304981-7a55-4f7d-9166-c0d613b13775" class="jump-link level-1" data-blockid="#block-0d304981-7a55-4f7d-9166-c0d613b13775">
						4. Reading image from Android Asset						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-03e7301c-e4da-4657-87d1-74ce72b56ff5" class="jump-link level-1" data-blockid="#block-03e7301c-e4da-4657-87d1-74ce72b56ff5">
						5. Loading Mobile Module						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-8e367e82-eda0-4ccf-b792-5e0c4b2989cc" class="jump-link level-1" data-blockid="#block-8e367e82-eda0-4ccf-b792-5e0c4b2989cc">
						6. Preparing Input						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-e618d1ec-e8eb-43c1-bdb0-54759133f6fc" class="jump-link level-1" data-blockid="#block-e618d1ec-e8eb-43c1-bdb0-54759133f6fc">
						7. Run Inference						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-17dc762b-ecbb-454d-99b9-d3ec282043bb" class="jump-link level-1" data-blockid="#block-17dc762b-ecbb-454d-99b9-d3ec282043bb">
						8. Processing results						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3d843c4f-f59c-45df-b640-cbb0e08dbfbd" class="jump-link level-1" data-blockid="#block-3d843c4f-f59c-45df-b640-cbb0e08dbfbd">
						PYTORCH DEMO APPLICATION						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-da9fb6fe-4006-4f6d-af86-51c1e92982f4" class="jump-link level-1" data-blockid="#block-da9fb6fe-4006-4f6d-af86-51c1e92982f4">
						Language Processing Example						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-2ab9801a-ab08-4315-9b4d-0a765a9ae512" class="jump-link level-1" data-blockid="#block-2ab9801a-ab08-4315-9b4d-0a765a9ae512">
						MORE PYTORCH ANDROID DEMO APPS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-f6d48450-34d4-4f98-88da-c4cc2e174bf6" class="jump-link level-1" data-blockid="#block-f6d48450-34d4-4f98-88da-c4cc2e174bf6">
						D2go						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-9557a72e-f61e-4708-93e6-f367be95c523" class="jump-link level-1" data-blockid="#block-9557a72e-f61e-4708-93e6-f367be95c523">
						Image Segmentation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-a2ae4f06-a4b0-4174-8fa2-1a6af8fc560e" class="jump-link level-1" data-blockid="#block-a2ae4f06-a4b0-4174-8fa2-1a6af8fc560e">
						Object Detection						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-32b33535-87fa-4c50-b5d2-1f1acdaae257" class="jump-link level-1" data-blockid="#block-32b33535-87fa-4c50-b5d2-1f1acdaae257">
						Neural Machine Translation						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-402abc6f-9c91-4f28-9845-e83ba5e1616b" class="jump-link level-1" data-blockid="#block-402abc6f-9c91-4f28-9845-e83ba5e1616b">
						Question Answering						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-5234adb7-21ac-479a-9dad-068667d0189d" class="jump-link level-1" data-blockid="#block-5234adb7-21ac-479a-9dad-068667d0189d">
						Vision Transformer						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-b36f68e6-4864-4f50-9b4f-6fc668155c0d" class="jump-link level-1" data-blockid="#block-b36f68e6-4864-4f50-9b4f-6fc668155c0d">
						Speech recognition						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-53aaede6-25f5-40ab-a710-7815b422910b" class="jump-link level-1" data-blockid="#block-53aaede6-25f5-40ab-a710-7815b422910b">
						Video Classification						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-508ff49b-9add-41b4-8cc5-dbb9c24bc64c" class="jump-link level-1" data-blockid="#block-508ff49b-9add-41b4-8cc5-dbb9c24bc64c">
						PYTORCH ANDROID TUTORIAL AND RECIPES						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-0e0bbd72-d3e6-400c-bb5f-f2a93245076e" class="jump-link level-1" data-blockid="#block-0e0bbd72-d3e6-400c-bb5f-f2a93245076e">
						Image Segmentation DeepLabV3 on Android						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-cac30e64-2655-4c9e-9d51-077b0b8827a6" class="jump-link level-1" data-blockid="#block-cac30e64-2655-4c9e-9d51-077b0b8827a6">
						PyTorch Mobile Performance Recipes						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-63edae1a-5eb5-45bf-aeb6-c459705ac226" class="jump-link level-1" data-blockid="#block-63edae1a-5eb5-45bf-aeb6-c459705ac226">
						Making Android Native Application That Uses PyTorc&#8230;						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-a6b93a2b-feda-4b3f-a392-df90b0649bfa" class="jump-link level-1" data-blockid="#block-a6b93a2b-feda-4b3f-a392-df90b0649bfa">
						Fuse Modules recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-5a6a2240-0c30-4581-92f2-d1cc61f29e3e" class="jump-link level-1" data-blockid="#block-5a6a2240-0c30-4581-92f2-d1cc61f29e3e">
						Quantization for Mobile Recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-fc788b7b-7e12-4995-ab75-e3c54be45d02" class="jump-link level-1" data-blockid="#block-fc788b7b-7e12-4995-ab75-e3c54be45d02">
						Script and Optimize for Mobile						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-2e8c7edc-b872-49f2-abf9-67ae7b5101d3" class="jump-link level-1" data-blockid="#block-2e8c7edc-b872-49f2-abf9-67ae7b5101d3">
						Model Preparation for Android Recipe						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-c6846267-7870-4f5d-9a0e-1e5e2582497f" class="jump-link level-1" data-blockid="#block-c6846267-7870-4f5d-9a0e-1e5e2582497f">
						BUILDING PYTORCH ANDROID FROM SOURCE						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3dce6560-3ab4-4bb8-b532-64492e1b2028" class="jump-link level-1" data-blockid="#block-3dce6560-3ab4-4bb8-b532-64492e1b2028">
						USING THE PYTORCH ANDROID LIBRARIES BUILT FROM SOU&#8230;						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3584f1c7-fe59-4ce1-9d7b-9aa2de391f2c" class="jump-link level-1" data-blockid="#block-3584f1c7-fe59-4ce1-9d7b-9aa2de391f2c">
						USING THE NIGHTLY PYTORCH ANDROID LIBRARIES						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-3282f9d8-8e8a-4432-9f0b-dd13c2c186df" class="jump-link level-1" data-blockid="#block-3282f9d8-8e8a-4432-9f0b-dd13c2c186df">
						CUSTOM BUILD						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-81f50b93-f6bf-4903-9406-5a6bee3f8c3a" class="jump-link level-1" data-blockid="#block-81f50b93-f6bf-4903-9406-5a6bee3f8c3a">
						USE PYTORCH JIT INTERPRETER						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-7dffeb3c-e1b1-4988-b138-05dcd493e64c" class="jump-link level-1" data-blockid="#block-7dffeb3c-e1b1-4988-b138-05dcd493e64c">
						ANDROID TUTORIALS						</a>
															</li>
									<li class="jump-list-single">
					
											<a href="#block-85ac6da6-36af-4028-9f93-c6cb8fd4da1d" class="jump-link level-1" data-blockid="#block-85ac6da6-36af-4028-9f93-c6cb8fd4da1d">
						API DOCS						</a>
															</li>
							</ul>
		</li>
	</ul>
</div>
				</div>
							</li>
								</ul>
</div>
		</div>
	</article>

	</main>

	<footer class="Footer">
		<div class="mainNav">
			<div class="logo">
				<a href="/" aria-label="Go to Pytorch home">
					<svg width="30" height="35" viewbox="0 0 30 35" fill="none" xmlns="http://www.w3.org/2000/svg" role="img">
<path d="M24.8384 10.3748L22.3344 12.8296C26.5077 16.9211 26.5077 23.5842 22.3344 27.6757C18.1612 31.7671 11.3647 31.7671 7.19148 27.6757C3.01823 23.5842 3.01823 16.9211 7.19148 12.8296L13.8687 6.28337L14.7033 5.34818V0.438477L4.56829 10.3748C-1.03579 15.869 -1.03579 24.6363 4.56829 30.1305C10.1724 35.6247 19.1151 35.6247 24.7191 30.1305C30.4424 24.6363 30.4424 15.7521 24.8384 10.3748Z" fill="#F05F42"></path>
<ellipse cx="19.8316" cy="7.80298" rx="1.90777" ry="1.87036" fill="#F05F42"></ellipse>
</svg>
				</a>
			</div>

			<ul class="footerNav">
													<li class="mainItem">
						<a href="#" target="" class="footer-item  ">
							PyTorch						</a>
													<ul>
																	<li class="subItem">
										<a href="/install/" target="" class=" ">
											Install										</a>
																			</li>
																	<li class="subItem">
										<a href="/features/" target="" class=" ">
											Features										</a>
																			</li>
																	<li class="subItem">
										<a href="/resources/" target="" class=" ">
											Resources										</a>
																			</li>
																	<li class="subItem">
										<a href="https://pytorch.org/docs/stable/index.html" target="" class="docs ">
											Docs										</a>
																			</li>
																	<li class="subItem">
										<a href="https://pytorch.org/tutorials/" target="" class="tutorials ">
											Tutorials										</a>
																			</li>
																	<li class="subItem">
										<a href="/community/" target="" class=" ">
											Community										</a>
																			</li>
																	<li class="subItem">
										<a href="https://github.com/pytorch/pytorch" target="" class=" ">
											Github										</a>
																			</li>
															</ul>
											</li>
									<li class="mainItem">
						<a href="#" target="" class="footer-item  ">
							Support						</a>
													<ul>
																	<li class="subItem">
										<a href="https://github.com/pytorch/pytorch/issues" target="_blank" class=" icon-github">
											Github Issues										</a>
																			</li>
																	<li class="subItem">
										<a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank" class=" ">
											Brand Guidelines										</a>
																			</li>
																	<li class="subItem">
										<a href="https://discuss.pytorch.org/" target="_blank" class=" ">
											Discuss										</a>
																			</li>
															</ul>
											</li>
								<li class="mainItem">
					
<div class="navItems-followContainer followMenu ">
			<div class="mainItem">Follow Us</div>
		<ul class="follow-list">
					<li class="followItem">
				<a href="https://twitter.com/pytorch" target="_blank" class=" icon-twitter">
					Twitter				</a>
			</li>
					<li class="followItem">
				<a href="https://www.facebook.com/pytorch" target="_blank" class=" icon-facebook">
					Facebook				</a>
			</li>
					<li class="followItem">
				<a href="https://www.youtube.com/pytorch" target="_blank" class=" icon-youtube">
					YouTube				</a>
			</li>
					<li class="followItem">
				<a href="https://www.linkedin.com/company/pytorch" target="_blank" class=" icon-linkedin">
					Linkedin				</a>
			</li>
					<li class="followItem">
				<a href="https://medium.com/pytorch" target="_blank" class=" icon-medium">
					Medium				</a>
			</li>
					<li class="followItem">
				<a href="https://github.com/pytorch/pytorch" target="_blank" class=" icon-github">
					GitHub				</a>
			</li>
			</ul>
</div>
				</li>
			</ul>
		</div>
		<div class="legalNav">
			<ul class="legalNavList">
													<li>
						<a href="/wp-content/uploads/2021/11/fb-tos-privacy-policy.pdf" target="" class=" ">
							Terms						</a>
					</li>
									<li>
						<a href="/wp-content/uploads/2021/11/fb-oss-privacy-policy.pdf" target="" class=" ">
							Privacy						</a>
					</li>
							</ul>
		</div>
	</footer>
</div>

<link rel="stylesheet" id="all-css-0" href="/_static/??-eJyVy0EOQDAQAMAPqW0R4iDeQm3aJq0VuyV+jx9wnMPAuSlLq+AqIB4TMmyX0G49TMwoDJYZ5khOhTQ5LB8W8D3FwPLjXJQlz6iOsCC9b0yDaRutTVV3/Q1Y0kAW" type="text/css" media="all">
<script id="pytorch-classic-js-js-extra">
var gridData = {"build":{"stable":"Stable (1.9.0)","nightly":"Preview (Nightly)","lts":"LTS (1.8.1)"},"os":{"mac":"MacOS","linux":"Linux","windows":"Windows"},"package":{"conda":"Conda","pip":"Pip","libtorch":"LibTorch","source":"Source"},"language":{"python":"Python","cplusplus":"C++\/Java"},"platform":{"cuda10.2":"CUDA 10.2","cuda11.1":"CUDA 11.1","rocm":"ROCm 4.2(beta)","cpu":"CPU"}};
var platformOSSupport = {"linux":["cuda10.2","rocm","cpu"],"mac":["cpu"],"windows":["cuda10.2","rocm","cpu"]};
var packageLanguageSupport = {"python":["pip","conda","source"],"cplusplus":["libtorch"]};
var commands = {"stable,conda,mac,cpu,python":"conda install pytorch torchvision torchaudio -c pytorch","nightly,conda,linux,cpu,python":"conda install pytorch torchvision torchaudio cpuonly -c pytorch-nightly","stable,libtorch,windows,rocm,cplusplus":"NOTE: ROCm is not available on Windows","stable,conda,windows,cpu,python":"conda install pytorch torchvision torchaudio cpuonly -c pytorch-nightly","stable,conda,windows,rocm,python":"NOTE: ROCm is not available on Windows","stable,pip,windows,rocm,python":"NOTE: ROCm is not available on Windows","stable,pip,windows,cpu,python":"pip3 install --pre torch torchvision torchaudio -f https:\/\/download.pytorch.org\/whl\/nightly\/cpu\/torch_nightly.html","stable,conda,windows,cuda10.2,python":"conda install pytorch torchvision torchaudio cudatoolkit=10.2 -c pytorch-nightly","stable,conda,windows,cuda11.1,python":"NOTE: \\'conda-forge\\' channel is required for cudatoolkit 11.1\r\nconda install pytorch torchvision torchaudio cudatoolkit=11.1 -c pytorch-nightly -c conda-forge","stable,libtorch,mac,rocm,cplusplus":"NOTE: ROCm is not available on MacOS","stable,conda,mac,rocm,python":"NOTE: ROCm is not available on MacOS","stable,conda,linux,cpu,python":"conda install pytorch torchvision torchaudio cpuonly -c pytorch","stable,conda,linux,rocm,python":"NOTE: Conda packages are not currently available for ROCm, please use pip instead","stable,conda,linux,cuda10.2,python":"conda install pytorch torchvision torchaudio cudatoolkit=10.2 -c pytorch","stable,conda,linux,cuda11.1,python":"NOTE: \\'nvidia\\' channel is required for cudatoolkit 11.1\r\nconda install pytorch torchvision torchaudio cudatoolkit=11.1 -c pytorch -c nvidia","lts,libtorch,windows,rocm,cplusplus":"NOTE: ROCm is not supported in LTS","lts,pip,mac,cpu,python":"# macOS is not currently supported for lts","lts,conda,mac,cuda10.2,python":"# macOS is not currently supported for lts","lts,conda,mac,cuda11.1,python":"# macOS is not currently supported for lts","lts,conda,mac,rocm,python":"# macOS is not currently supported for lts","lts,conda,mac,cpu,python":"# macOS is not currently supported for lts","stable,conda,mac,cuda10.2,python":"# MacOS Binaries dont support CUDA, install from source if CUDA is needed\r\nconda install pytorch torchvision torchaudio -c pytorch","lts,libtorch,mac,cpu,cplusplus":"# macOS is not currently supported for lts","lts,libtorch,mac,cuda10.2,cplusplus":"# macOS is not currently supported for lts","lts,libtorch,mac,cuda11.1,cplusplus":"# macOS is not currently supported for lts","lts,libtorch,mac,rocm,cplusplus":"# macOS is not currently supported for lts","lts,pip,windows,rocm,python":"NOTE: ROCm is not supported in LTS","stable,libtorch,linux,cpu,cplusplus":"Download here (Pre-cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cpu\/libtorch-shared-with-deps-1.9.1%2Bcpu.zip\">https:\/\/download.pytorch.org\/libtorch\/cpu\/libtorch-shared-with-deps-1.9.1%2Bcpu.zip<\/a>\r\nDownload here (cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cpu\/libtorch-cxx11-abi-shared-with-deps-1.9.1%2Bcpu.zip\">https:\/\/download.pytorch.org\/libtorch\/cpu\/libtorch-cxx11-abi-shared-with-deps-1.9.1%2Bcpu.zip<\/a>","stable,pip,linux,cpu,python":"pip3 install --pre torch torchvision torchaudio -f https:\/\/download.pytorch.org\/whl\/nightly\/cpu\/torch_nightly.html","stable,pip,linux,cuda11.1,python":"pip3 install torch==1.9.1+cu111 torchvision==0.10.1+cu111 torchaudio==0.9.1 -f https:\/\/download.pytorch.org\/whl\/torch_stable.html","stable,pip,linux,cuda10.2,python":"pip3 install torch torchvision torchaudio","stable,pip,linux,rocm,python":"pip3 install torch torchvision==0.10.1 -f https:\/\/download.pytorch.org\/whl\/rocm4.2\/torch_stable.html","stable,libtorch,linux,cuda10.2,cplusplus":"Download here (Pre-cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cu102\/libtorch-shared-with-deps-1.9.1%2Bcu102.zip\">https:\/\/download.pytorch.org\/libtorch\/cu102\/libtorch-shared-with-deps-1.9.1%2Bcu102.zip<\/a>\r\nDownload here (cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cu102\/libtorch-cxx11-abi-shared-with-deps-1.9.1%2Bcu102.zip\">https:\/\/download.pytorch.org\/libtorch\/cu102\/libtorch-cxx11-abi-shared-with-deps-1.9.1%2Bcu102.zip<\/a>","stable,libtorch,linux,cuda11.1,cplusplus":"Download here (Pre-cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cu111\/libtorch-shared-with-deps-1.9.1%2Bcu111.zip\">https:\/\/download.pytorch.org\/libtorch\/cu111\/libtorch-shared-with-deps-1.9.1%2Bcu111.zip<\/a>\r\nDownload here (cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cu111\/libtorch-cxx11-abi-shared-with-deps-1.9.1%2Bcu111.zip\">https:\/\/download.pytorch.org\/libtorch\/cu111\/libtorch-cxx11-abi-shared-with-deps-1.9.1%2Bcu111.zip<\/a>","stable,libtorch,linux,rocm,cplusplus":"LibTorch binaries are not available for ROCm, please build it from source","stable,pip,mac,cuda10.2,python":"# MacOS Binaries dont support CUDA, install from source if CUDA is needed\r\npip3 install torch torchvision torchaudio","stable,pip,mac,cuda11.1,python":"# MacOS Binaries dont support CUDA, install from source if CUDA is needed\r\npip3 install torch torchvision torchaudio","stable,pip,mac,rocm,python":"NOTE: ROCm is not available on MacOS","stable,pip,mac,cpu,python":"pip3 install torch torchvision torchaudio","stable,conda,mac,cuda11.1,python":"# MacOS Binaries dont support CUDA, install from source if CUDA is needed\r\nconda install pytorch torchvision torchaudio -c pytorch","stable,libtorch,mac,cpu,cplusplus":"Download here:\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cpu\/libtorch-macos-1.9.1.zip\">https:\/\/download.pytorch.org\/libtorch\/cpu\/libtorch-macos-1.9.1.zip<\/a>","stable,libtorch,mac,cuda10.2,cplusplus":"MacOS binaries do not support CUDA. Download CPU libtorch here:\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cpu\/libtorch-macos-1.9.1.zip\">https:\/\/download.pytorch.org\/libtorch\/cpu\/libtorch-macos-1.9.1.zip<\/a>","stable,libtorch,mac,cuda11.1,cplusplus":"MacOS binaries do not support CUDA. Download CPU libtorch here:\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cpu\/libtorch-macos-1.9.1.zip\">https:\/\/download.pytorch.org\/libtorch\/cpu\/libtorch-macos-1.9.1.zip<\/a>","stable,libtorch,windows,cuda11.1,python":"Download here (Release version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cu111\/libtorch-win-shared-with-deps-1.9.1%2Bcu111.zip\">https:\/\/download.pytorch.org\/libtorch\/cu111\/libtorch-win-shared-with-deps-1.9.1%2Bcu111.zip<\/a>\r\nDownload here (Debug version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/cu111\/libtorch-win-shared-with-deps-debug-1.9.1%2Bcu111.zip\">https:\/\/download.pytorch.org\/libtorch\/cu111\/libtorch-win-shared-with-deps-debug-1.9.1%2Bcu111.zip<\/a>","stable,libtorch,windows,cuda10.2,cplusplus":"Download here (Release version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/nightly\/cu102\/libtorch-win-shared-with-deps-latest.zip\">https:\/\/download.pytorch.org\/libtorch\/nightly\/cu102\/libtorch-win-shared-with-deps-latest.zip<\/a>\r\nDownload here (Debug version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/nightly\/cu102\/libtorch-win-shared-with-deps-debug-latest.zip\">https:\/\/download.pytorch.org\/libtorch\/nightly\/cu102\/libtorch-win-shared-with-deps-debug-latest.zip<\/a>","stable,libtorch,windows,cpu,cplusplus":"Download here (Release version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/nightly\/cpu\/libtorch-win-shared-with-deps-latest.zip\">https:\/\/download.pytorch.org\/libtorch\/nightly\/cpu\/libtorch-win-shared-with-deps-latest.zip<\/a>\r\nDownload here (Debug version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/nightly\/cpu\/libtorch-win-shared-with-deps-debug-latest.zip\">https:\/\/download.pytorch.org\/libtorch\/nightly\/cpu\/libtorch-win-shared-with-deps-debug-latest.zip<\/a>","stable,pip,windows,cuda11.1,python":"pip3 install --pre torch torchvision torchaudio -f https:\/\/download.pytorch.org\/whl\/nightly\/cu111\/torch_nightly.html","stable,pip,windows,cuda10.2,python":"pip3 install --pre torch torchvision torchaudio -f https:\/\/download.pytorch.org\/whl\/nightly\/cu102\/torch_nightly.html","stable,libtorch,windows,cuda11.1,cplusplus":"Download here (Release version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/nightly\/cu111\/libtorch-win-shared-with-deps-latest.zip\">https:\/\/download.pytorch.org\/libtorch\/nightly\/cu111\/libtorch-win-shared-with-deps-latest.zip<\/a>\r\nDownload here (Debug version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/nightly\/cu111\/libtorch-win-shared-with-deps-debug-latest.zip\">https:\/\/download.pytorch.org\/libtorch\/nightly\/cu111\/libtorch-win-shared-with-deps-debug-latest.zip<\/a>","lts,pip,linux,cpu,python":"pip3 install torch==1.8.2+cpu torchvision==0.9.2+cpu torchaudio==0.8.2 -f https:\/\/download.pytorch.org\/whl\/lts\/1.8\/torch_lts.html","lts,pip,linux,cuda10.2,python":"pip3 install torch==1.8.2+cu102 torchvision==0.9.2+cu102 torchaudio==0.8.2 -f https:\/\/download.pytorch.org\/whl\/lts\/1.8\/torch_lts.html","lts,pip,linux,cuda11.1,python":"pip3 install torch==1.8.2+cu111 torchvision==0.9.2+cu111 torchaudio==0.8.2 -f https:\/\/download.pytorch.org\/whl\/lts\/1.8\/torch_lts.html","lts,pip,linux,rocm,python":"NOTE: ROCm is not supported in LTS","lts,conda,linux,cuda10.2,python":"conda install pytorch torchvision torchaudio cudatoolkit=10.2 -c pytorch-lts","lts,conda,linux,cuda11.1,python":"NOTE: \\'nvidia\\' channel is required for cudatoolkit 11.1\r\nconda install pytorch torchvision torchaudio cudatoolkit=11.1 -c pytorch-lts -c nvidia","lts,conda,linux,rocm,python":"NOTE: ROCm is not supported in LTS","lts,conda,linux,cpu,python":"conda install pytorch torchvision torchaudio cpuonly -c pytorch-lts","lts,libtorch,linux,cpu,cplusplus":"Download here (Pre-cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cpu\/libtorch-shared-with-deps-1.8.2%2Bcpu.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cpu\/libtorch-shared-with-deps-1.8.2%2Bcpu.zip<\/a>\r\nDownload here (cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cpu\/libtorch-cxx11-abi-shared-with-deps-1.8.2%2Bcpu.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cpu\/libtorch-cxx11-abi-shared-with-deps-1.8.2%2Bcpu.zip<\/a>","lts,libtorch,linux,cuda10.2,cplusplus":"Download here (Pre-cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu102\/libtorch-shared-with-deps-1.8.2%2Bcu102.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu102\/libtorch-shared-with-deps-1.8.2%2Bcu102.zip<\/a>\r\nDownload here (cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu102\/libtorch-cxx11-abi-shared-with-deps-1.8.2%2Bcu102.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu102\/libtorch-cxx11-abi-shared-with-deps-1.8.2%2Bcu102.zip<\/a>","lts,libtorch,linux,cuda11.1,cplusplus":"Download here (Pre-cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu111\/libtorch-shared-with-deps-1.8.2%2Bcu111.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu111\/libtorch-shared-with-deps-1.8.2%2Bcu111.zip<\/a>\r\nDownload here (cxx11 ABI):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu111\/libtorch-cxx11-abi-shared-with-deps-1.8.2%2Bcu111.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu111\/libtorch-cxx11-abi-shared-with-deps-1.8.2%2Bcu111.zip<\/a>","lts,libtorch,linux,rocm,python":"NOTE: ROCm is not supported in LTS","lts,pip,mac,cuda10.2,python":"# macOS is not currently supported for lts","lts,pip,mac,cuda11.1,python":"# macOS is not currently supported for lts","lts,pip,mac,rocm,python":"# macOS is not currently supported for lts","lts,pip,windows,cpu,python":"pip3 install torch==1.8.2+cpu torchvision==0.9.2+cpu torchaudio===0.8.2 -f https:\/\/download.pytorch.org\/whl\/lts\/1.8\/torch_lts.html","lts,pip,windows,cuda10.2,python":"pip3 install torch==1.8.2+cu102 torchvision==0.9.2+cu102 torchaudio===0.8.2 -f https:\/\/download.pytorch.org\/whl\/lts\/1.8\/torch_lts.html","lts,pip,windows,cuda11.1,python":"pip3 install torch==1.8.2+cu111 torchvision==0.9.2+cu111 torchaudio===0.8.2 -f https:\/\/download.pytorch.org\/whl\/lts\/1.8\/torch_lts.html","lts,conda,windows,cuda10.2,python":"conda install pytorch torchvision torchaudio cudatoolkit=10.2 -c pytorch-lts","lts,conda,windows,cuda11.1,python":"NOTE: \\'conda-forge\\' channel is required for cudatoolkit 11.1\r\nconda install pytorch torchvision torchaudio cudatoolkit=11.1 -c pytorch-lts -c conda-forge","lts,conda,windows,cpu,python":"conda install pytorch torchvision torchaudio cpuonly -c pytorch-lts","lts,conda,windows,rocm,python":"NOTE: ROCm is not supported in LTS","lts,libtorch,windows,cpu,cplusplus":"Download here (Release version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cpu\/libtorch-win-shared-with-deps-1.8.2%2Bcpu.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cpu\/libtorch-win-shared-with-deps-1.8.2%2Bcpu.zip<\/a>\r\nDownload here (Debug version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cpu\/libtorch-win-shared-with-deps-debug-1.8.2%2Bcpu.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cpu\/libtorch-win-shared-with-deps-debug-1.8.2%2Bcpu.zip<\/a>","lts,libtorch,windows,cuda10.2,cplusplus":"Download here (Release version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu102\/libtorch-win-shared-with-deps-1.8.2%2Bcu102.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu102\/libtorch-win-shared-with-deps-1.8.2%2Bcu102.zip<\/a>\r\nDownload here (Debug version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu102\/libtorch-win-shared-with-deps-debug-1.8.2%2Bcu102.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu102\/libtorch-win-shared-with-deps-debug-1.8.2%2Bcu102.zip<\/a>","lts,libtorch,windows,cuda11.1,cplusplus":"Download here (Release version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu111\/libtorch-win-shared-with-deps-1.8.2%2Bcu111.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu111\/libtorch-win-shared-with-deps-1.8.2%2Bcu111.zip<\/a>\r\nDownload here (Debug version):\r\n<a href=\"https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu111\/libtorch-win-shared-with-deps-debug-1.8.2%2Bcu111.zip\">https:\/\/download.pytorch.org\/libtorch\/lts\/1.8\/cu111\/libtorch-win-shared-with-deps-debug-1.8.2%2Bcu111.zip<\/a>"};
</script>
<script id="mkaz-code-syntax-prism-js-js-extra">
var prism_settings = {"pluginUrl":"\/wp-content\/plugins\/code-syntax-block\/"};
</script>
<script type="text/javascript" src="/_static/??-eJyd0EsOwjAMBNALEcJPIBaIs6SJaV3yU8eB9vYgEGJVibDx7nk81vesbIpCUbR0FAg6T5IG22kDkED30BwdjcumROdp2WOhf0EdGUdDrRLToNaArHCK1VE0yj+lOLYzLPvScoS2yZHCFMWMqvHJXj8b8sAI7zlnwSH7SUGMsFV5SB97KZgNnEVAViDzLPFzxefBreJgWqp9zkt6RvVXp1SkNKRu7Ch98Tmc1vvdarXebA/H/gEcNgGq"></script><script src="https://stats.wp.com/e-202151.js" defer></script>
<script>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:10.4',blog:'195752808',post:'57',tz:'0',srv:'pytorch-org-preprod.go-vip.net'} ]);
	_stq.push([ 'clickTrackerInit', '195752808', '57' ]);
</script>

</body>
</html>